
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const UE=require("ue"),Log_1=require("../../Core/Common/Log"),TsBaseCharacter_1=require("../Character/TsBaseCharacter"),ModelManager_1=require("../Manager/ModelManager"),PanelQteController_1=require("../Module/PanelQte/PanelQteController");class TsAnimNotifyChangeRoleQte extends UE.KuroAnimNotify{constructor(){super(...arguments),this.QteId=0,this.QteDistance=0}Constructor(){}K2_Notify(r,e){if(!ModelManager_1.ModelManager.GameModeModel.IsMulti){var t=ModelManager_1.ModelManager.SceneTeamModel.GetCurrentTeamItem;if(t?.EntityHandle?.Entity?.GetComponent(194)?.HasTag(-1697149502))Log_1.Log.CheckDebug()&&Log_1.Log.Debug("PanelQte",17,"当前角色不能下场，不触发换人QTE");else{if(0<this.QteDistance){var o=r.GetOwner()?.D_K2_GetActorLocation(),a=t?.EntityHandle?.Entity?.GetComponent(3).ActorLocationProxy;if(!o||!a)return Log_1.Log.CheckDebug()&&Log_1.Log.Debug("PanelQte",17,"读取不到坐标，不触发换人QTE"),!0;if(Math.pow(o.X-a.X,2)+Math.pow(o.Y-a.Y,2)+Math.pow(o.Z-a.Z,2)>this.QteDistance*this.QteDistance)return Log_1.Log.CheckDebug()&&Log_1.Log.Debug("PanelQte",17,"距离太远，不触发换人QTE"),!0}let e=void 0;o=r.GetOwner();o instanceof TsBaseCharacter_1.default&&(a=o?.CharacterActorComponent?.Entity,e=a?.GetComponent(198).CreateAnimNotifyContent());for(const n of ModelManager_1.ModelManager.SceneTeamModel.GetTeamItems())if(n.GetCreatureDataId()!==t?.GetCreatureDataId()&&0===n.CanGoBattle())return PanelQteController_1.PanelQteController.StartAnimNotifyQte(this.QteId,r,e),!0;Log_1.Log.CheckDebug()&&Log_1.Log.Debug("PanelQte",17,"没有后台角色能上场，不触发换人QTE")}}return!0}GetNotifyName(){return"换人QTE"}}exports.default=TsAnimNotifyChangeRoleQte;
//# sourceMappingURL=TsAnimNotifyChangeRoleQte.js.map