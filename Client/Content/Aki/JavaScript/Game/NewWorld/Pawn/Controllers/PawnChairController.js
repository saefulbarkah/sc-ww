
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.PawnChairController=exports.SubEntityInteractLogicController=void 0;const puerts_1=require("puerts"),Log_1=require("../../../../Core/Common/Log"),Vector_1=require("../../../../Core/Utils/Math/Vector"),ModelManager_1=require("../../../Manager/ModelManager");class SubEntityInteractLogicController{constructor(t){this.MasterEntity=void 0,this.Entity=void 0,this.CreatureDataComp=void 0,this.InteractComp=void 0,this.CreatureDataComp=t,this.Entity=t.Entity,this.InteractComp=this.Entity.GetComponent(181)?.GetInteractController()}Possess(t,r=0){return!0}UnPossess(t){return!0}IsPossessed(){return void 0!==this.MasterEntity}IsPossessedBy(t){return void 0!==this.MasterEntity&&this.MasterEntity===t}Dispose(){this.MasterEntity=void 0,this.Entity=void 0,this.CreatureDataComp=void 0,this.InteractComp=void 0}}(exports.SubEntityInteractLogicController=SubEntityInteractLogicController).TmpVector=Vector_1.Vector.Create(),SubEntityInteractLogicController.TmpVector2=Vector_1.Vector.Create();class PawnChairController extends SubEntityInteractLogicController{constructor(){super(...arguments),this.NDa=40,this.mrr=void 0}Possess(t,r){return this.MasterEntity=t,!0}UnPossess(t){return!(this.MasterEntity=void 0)}GetSitLocation(){var t=PawnChairController.TmpVector,r=(t.Reset(),PawnChairController.TmpVector2),e=this.Entity.GetComponent(1),s=(r.DeepCopy(e.ActorLocationProxy),this.MasterEntity.GetComponent(2)),i=s.ScaledHalfHeight,s=s.ActorLocationProxy;return(this.mrr||e).ActorRightProxy.Multiply(this.NDa,t),r.Z=this.mrr?this.mrr.ActorLocationProxy.Z+i:s.Z,t.AdditionEqual(r),t}GetForwardDirection(){return this.Entity.GetComponent(1).ActorRightProxy}drr(r){if(this.mrr&&this.MasterEntity){var t,e=this.MasterEntity.GetComponent(2),s=(e.Actor.CapsuleComponent.SetCollisionResponseToChannel(2,r?0:2),(0,puerts_1.$ref)(void 0)),i=(this.mrr.Owner.GetAttachedActors(s),(0,puerts_1.$unref)(s)),o=i.Num();0===o&&(s=this.CreatureDataComp.GetPbDataId(),t=this.mrr.CreatureData.GetPbDataId(),Log_1.Log.CheckWarn())&&Log_1.Log.Warn("AI",51,"[PawnChairController] Scene Interaction Loaded UnComplete!",["itemPbDataId",s],["OwnerPbDataId",t]);for(let t=0;t<o;++t){var n=i.Get(t),a=(0,puerts_1.$ref)(void 0),h=(n.GetAttachedActors(a),(0,puerts_1.$unref)(a)),l=h.Num();for(let t=0;t<l;++t)e.Actor.CapsuleComponent.IgnoreActorWhenMoving(h.Get(t),r)}}}ResetCollision(){this.Entity.GetComponent(185)&&this.drr(!1)}IgnoreCollision(){this.Entity.GetComponent(185)&&this.drr(!0)}IsSceneInteractionLoadCompleted(){var t=this.Entity.GetComponent(185);if(!t)return!1;var r=this.CreatureDataComp.GetPbDataId();const e=ModelManager_1.ModelManager.CreatureModel.GetOwnerEntity(r);if(e&&(r=ModelManager_1.ModelManager.CreatureModel.GetEntityByPbDataId(e))&&(this.mrr=r.Entity.GetComponent(185)),this.mrr||(this.mrr=t),!this.mrr.Owner)return!1;r=(0,puerts_1.$ref)(void 0);if(this.mrr.Owner.GetAttachedActors(r),0!==(0,puerts_1.$unref)(r).Num())return!0;{t=this.CreatureDataComp.GetPbDataId();const e=this.mrr.CreatureData.GetPbDataId();return Log_1.Log.CheckWarn()&&Log_1.Log.Warn("AI",51,"[PawnChairController] Scene Interaction Loaded UnComplete!",["itemPbDataId",t],["OwnerPbDataId",e]),!1}}}exports.PawnChairController=PawnChairController;
//# sourceMappingURL=PawnChairController.js.map