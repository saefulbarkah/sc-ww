
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const puerts_1=require("puerts"),UE=require("ue"),EntitySystem_1=require("../../../../../../Core/Entity/EntitySystem"),MathUtils_1=require("../../../../../../Core/Utils/MathUtils"),ModelManager_1=require("../../../../../Manager/ModelManager"),UiCameraAnimationManager_1=require("../../../../../Module/UiCameraAnimation/UiCameraAnimationManager"),VehicleInfoDefines_1=require("../../../../Vehicle/Common/VehicleInfoDefines");class TsVehicleBlueprintFunctionLibrary extends UE.BlueprintFunctionLibrary{Constructor(){}static UpdateVehiclePerformData(e,t,i,r){e=EntitySystem_1.EntitySystem.GetComponent(e,231);e&&((0,puerts_1.$set)(t,e.IsBeingImpacted),(0,puerts_1.$set)(i,e.CollisionDirection),(0,puerts_1.$set)(r,e.CollisionStrength))}static UpdateDrivedVehiclePerformData(e,t,i,r){e=EntitySystem_1.EntitySystem.GetComponent(e,223)?.VehicleEntity?.GetComponent(231);e&&((0,puerts_1.$set)(t,e.IsBeingImpacted),(0,puerts_1.$set)(i,e.CollisionDirection),(0,puerts_1.$set)(r,e.CollisionStrength))}static UpdateAnimInfo(e){TsVehicleBlueprintFunctionLibrary.UpdateAnimInfoMove(e),TsVehicleBlueprintFunctionLibrary.UpdateAnimInfoUnifiedState(e)}static UpdateAnimInfoMove(e){var t,i,r,n=EntitySystem_1.EntitySystem.GetComponent(e,229);n?.Valid&&(t=n.MainAnimInstance?.LogicParams)?.IsValid()&&(n=n.AnimLogicParamsSetter,(i=EntitySystem_1.EntitySystem.GetComponent(e,228))?.Valid&&(r=i.InputDirectProxy,n.InputDirect.Equals(r)||(n.InputDirect.DeepCopy(r),t.InputDirectRef=r.ToUeVectorOld()),r=i.InputRotatorProxy,n.InputRotator.Equals(r)||(n.InputRotator.DeepCopy(r),t.InputRotatorRef=r.ToUeRotator())),(i=EntitySystem_1.EntitySystem.GetComponent(e,230))?.Valid)&&(r=i.Acceleration,n.Acceleration.Equals(r)||(n.Acceleration.DeepCopy(r),t.AccelerationRef=r.ToUeVectorOld()),e=i.IsMoving,n.IsMoving!==e&&(n.IsMoving=e,t.IsMovingRef=e),r=i.HasMoveInput,n.HasMoveInput!==r&&(n.HasMoveInput=r,t.HasMoveInputRef=r),e=i.Speed,n.Speed!==e)&&(n.Speed=e,t.SpeedRef=e)}static UpdateAnimInfoUnifiedState(e){var t,i,e=EntitySystem_1.EntitySystem.GetComponent(e,229);e?.Valid&&(t=e.MainAnimInstance?.LogicParams)?.IsValid()&&(e=e.AnimLogicParamsSetter,i=ModelManager_1.ModelManager.PlotModel.IsInInteraction||ModelManager_1.ModelManager.PlotModel.IsInPlot&&"LevelD"!==ModelManager_1.ModelManager.PlotModel.PlotConfig.PlotLevel,e.IsInPerformingPlot!==i&&(e.IsInPerformingPlot=i,t.bIsInPerformingPlot=i),i=ModelManager_1.ModelManager.PlotModel.IsInPlot&&("LevelA"===ModelManager_1.ModelManager.PlotModel.PlotConfig.PlotLevel||"LevelB"===ModelManager_1.ModelManager.PlotModel.PlotConfig.PlotLevel),e.IsInSequence!==i&&(e.IsInSequence=i,t.bIsInSequence=i),i=UiCameraAnimationManager_1.UiCameraAnimationManager.IsDisablePlayer(),e.IsInUiCamera!==i)&&(e.IsInUiCamera=i,t.bIsInUiCamera=i)}static GetAndResetEnterSprint(e){var t,e=EntitySystem_1.EntitySystem.GetComponent(e,239);return!!e&&(t=e.IsEnterSprint,e.IsEnterSprint=!1,t)}static GetDrivedVehicleSeatRot(e,t){e=EntitySystem_1.EntitySystem.GetComponent(e,223);if(!e?.VehicleEntity)return!1;var i=e.Seat;if(-1===i)return!1;var r=e.VehicleEntity.GetComponent(239);if(!r?.IsWaterfallMove){r=e.VehicleEntity.GetComponent(228)?.SkeletalMesh?.GetSocketRotation(VehicleInfoDefines_1.VehicleInfoDefines.GetSeatSocketName(i));if(!r)return!1;e=(0,puerts_1.$unref)(t);e.Pitch=r.Pitch,e.Yaw=r.Yaw,e.Roll=r.Roll}return!0}static ConvertAngleToPassengerSpace(e,t){var e=EntitySystem_1.EntitySystem.GetComponent(e,223);return e?.IsOnVehicle?(e=-e.SeatReletiveTrans.GetRotation().Rotator().Yaw,MathUtils_1.MathUtils.WrapAngle(t+e)):0}static GetVehicleVelocity(e,t){e=EntitySystem_1.EntitySystem.GetComponent(e,228);if(!e?.Actor?.IsValid())return!1;var i=MathUtils_1.MathUtils.CommonTempVector;i.Reset();e.Entity.GetComponent(227)?.GetVehicleVelocity(i);e=(0,puerts_1.$unref)(t);return e.X=i.X,e.Y=i.Y,e.Z=i.Z,!0}static GetDrivedVehicleVelocity(e,t){e=EntitySystem_1.EntitySystem.GetComponent(e,223);if(!e?.IsOnVehicle)return!1;if(!e.VehicleEntity.GetComponent(228)?.Actor?.IsValid())return!1;var i=MathUtils_1.MathUtils.CommonTempVector;i.Reset();e.VehicleEntity.GetComponent(227)?.GetVehicleVelocity(i);e=(0,puerts_1.$unref)(t);return e.X=i.X,e.Y=i.Y,e.Z=i.Z,!0}static GetVehicleRotiationSpeed(e){e=EntitySystem_1.EntitySystem.GetComponent(e,228);return e?.Actor?.IsValid()?e.SimulatedRotYawSpeed:0}static GetDrivedVehicleRotiationSpeed(e){var e=EntitySystem_1.EntitySystem.GetComponent(e,223);return e?.IsOnVehicle&&(e=e.VehicleEntity.GetComponent(228))?.Actor?.IsValid()?e.SimulatedRotYawSpeed:0}}exports.default=TsVehicleBlueprintFunctionLibrary;
//# sourceMappingURL=TsVehicleBlueprintFunctionLibrary.js.map