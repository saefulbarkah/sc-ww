
"use strict";var CharacterDriveVehicleComponent_1,__decorate=this&&this.__decorate||function(t,e,i,r){var n,h=arguments.length,s=h<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,r);else for(var o=t.length-1;0<=o;o--)(n=t[o])&&(s=(h<3?n(s):3<h?n(e,i,s):n(e,i))||s);return 3<h&&s&&Object.defineProperty(e,i,s),s};Object.defineProperty(exports,"__esModule",{value:!0}),exports.CharacterDriveVehicleComponent=void 0;const UE=require("ue"),EntityComponent_1=require("../../../../../Core/Entity/EntityComponent"),RegisterComponent_1=require("../../../../../Core/Entity/RegisterComponent"),MathUtils_1=require("../../../../../Core/Utils/MathUtils");let CharacterDriveVehicleComponent=CharacterDriveVehicleComponent_1=class CharacterDriveVehicleComponent extends EntityComponent_1.EntityComponent{constructor(){super(...arguments),this.ActorComp=void 0,this.MoveComp=void 0,this.TagComp=void 0,this.UnifiedStateComp=void 0,this.VehicleInfo=void 0}get IsDriver(){return!!this.VehicleInfo?.IsDriver}get IsOnVehicle(){return!!this.VehicleInfo}get VehicleEntity(){return this.VehicleInfo?.VehicleEntity}OnInitData(t){return!0}OnInit(t){return!0}OnStart(){return this.ActorComp=this.Entity.GetComponent(3),this.MoveComp=this.Entity.GetComponent(164),this.TagComp=this.Entity.GetComponent(191),this.UnifiedStateComp=this.Entity.GetComponent(161),!0}OnActivate(){}OnTick(t){}OnEnd(){return!0}OnClear(){return!0}OnDisable(t){}OnEnable(){}EnterVehicle(t){return!this.VehicleInfo&&(this.VehicleInfo=t,this.MoveComp.IsSpecialMove=!0,this.TagComp.AddTag(525255941),this.ClearCurrentState(),this.AttachAndSetPassengerTransform(),!0)}LeaveVehicle(t){return!!this.VehicleInfo&&(this.VehicleInfo=void 0,this.MoveComp.IsSpecialMove=!1,this.TagComp.RemoveTag(525255941),this.ActorComp.Actor.K2_DetachFromActor(1,1,1),!0)}ClearCurrentState(){this.ActorComp.ClearInput();var t=this.Entity.GetComponent(34);t.Valid&&t.CurrentSkill&&t.StopGroup1Skill("进入载具打断技能"),this.ActorComp?.Actor.CharacterMovement?.SetMovementMode(0)}AttachAndSetPassengerTransform(){var t,e;this.VehicleInfo&&((e=(t=this.VehicleInfo.VehicleEntity.GetComponent(214)).Actor.Mesh.GetSocketLocation(CharacterDriveVehicleComponent_1.DriverSeatSocketName))?(MathUtils_1.MathUtils.CommonTempVector.FromUeVector(e),MathUtils_1.MathUtils.CommonTempVector.Z=t.ActorLocationProxy.Z):MathUtils_1.MathUtils.CommonTempVector.DeepCopy(t.ActorLocationProxy),MathUtils_1.MathUtils.CommonTempVector.Z+=this.ActorComp.HalfHeight,this.ActorComp.SetActorLocation(MathUtils_1.MathUtils.CommonTempVector.ToUeVector(),"进入载具",!1),MathUtils_1.MathUtils.LookRotationForwardFirst(t.ActorForwardProxy,t.ActorUpProxy,MathUtils_1.MathUtils.CommonTempRotator),this.ActorComp.SetActorRotation(MathUtils_1.MathUtils.CommonTempRotator.ToUeRotator(),"进入载具",!1),this.ActorComp.Actor.K2_AttachToComponent(t.Actor.Mesh,CharacterDriveVehicleComponent_1.DriverSeatSocketName,1,1,1,!1))}};CharacterDriveVehicleComponent.DriverSeatSocketName=new UE.FName("SeatProp01"),CharacterDriveVehicleComponent=CharacterDriveVehicleComponent_1=__decorate([(0,RegisterComponent_1.RegisterComponent)(213)],CharacterDriveVehicleComponent),exports.CharacterDriveVehicleComponent=CharacterDriveVehicleComponent;
//# sourceMappingURL=CharacterDriveVehicleComponent.js.map