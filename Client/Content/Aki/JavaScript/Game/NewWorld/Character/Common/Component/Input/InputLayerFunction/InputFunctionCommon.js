
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.createInputCommandFromDataTable=exports.canVehicleResponseInput=exports.canResponseInput=exports.createSkillCommand=void 0;const UE=require("ue"),Log_1=require("../../../../../../../Core/Common/Log"),EntitySystem_1=require("../../../../../../../Core/Entity/EntitySystem"),ModelManager_1=require("../../../../../../Manager/ModelManager"),Skill_1=require("../../Skill/Skill"),SkillBehaviorCondition_1=require("../../Skill/SkillBehavior/SkillBehaviorCondition"),tempSkill=new Skill_1.Skill;function createSkillCommand(e,t){if(0!==t){var n,o,i,e=e.GetComponent(38);if(e&&e.Valid)return n=e.GetSkillInfo(t),o=e.GetPriority(t),i=e.GetSkillIdWithGroupId(1),(i=e.GetActivePriority(i))<o||e.IsMainSkillReadyEnd||o===i&&e.SkillAcceptInput||n&&1!==n.GroupId?new UE.SInputCommand(1,t,void 0):void 0}}function canResponseInput(e){return!!e.GetComponent(44)?.CanResponseInput()&&!e.GetComponent(200)?.HasAnyTag([-2044964178,855966206,504239013,-2100129479,-1159105522,-648310348,1501154053])}function canVehicleResponseInput(e){return!!e.GetComponent(230)?.CanResponseInput()&&!e.GetComponent(200)?.HasTag(1646668090)}function createInputCommandFromDataTable(e,t,n){var o=EntitySystem_1.EntitySystem.Get(e);if(o){var i=EntitySystem_1.EntitySystem.GetComponent(e,200),r=EntitySystem_1.EntitySystem.GetComponent(e,38);if(i&&r){e=ModelManager_1.ModelManager.InputModel?.GetInputCommandTransformData(t,n);if(e)for(const l of e)if(i.HasTag(l.Tag.TagId)){let e=!1;if(e=0===l.BehaviorConditionGroup.Num()||SkillBehaviorCondition_1.SkillBehaviorCondition.SatisfyGroup(l.BehaviorConditionGroup,l.BehaviorConditionFormula,{Entity:o,SkillComponent:r,Skill:tempSkill})?!0:e)return Log_1.Log.CheckDebug()&&Log_1.Log.Debug("Battle",67,"[通用输入转换]指令转换成功",["Desc",l.Desc],["Action",l.Action],["State",l.State],["Tag",l.Tag.TagName],["CommandType",l.Command.CommandType],["CommandValue",l.Command.IntValue]),1===l.Command.CommandType?createSkillCommand(o,l.Command.IntValue):new UE.SInputCommand(l.Command.CommandType,l.Command.IntValue,l.Command.TagValue)}}}}exports.createSkillCommand=createSkillCommand,exports.canResponseInput=canResponseInput,exports.canVehicleResponseInput=canVehicleResponseInput,exports.createInputCommandFromDataTable=createInputCommandFromDataTable;
//# sourceMappingURL=InputFunctionCommon.js.map