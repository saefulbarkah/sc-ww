
"use strict";var __decorate=this&&this.__decorate||function(t,e,i,r){var n,s=arguments.length,o=s<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,r);else for(var _=t.length-1;0<=_;_--)(n=t[_])&&(o=(s<3?n(o):3<s?n(e,i,o):n(e,i))||o);return 3<s&&o&&Object.defineProperty(e,i,o),o};Object.defineProperty(exports,"__esModule",{value:!0}),exports.CharacterKiteComponent=void 0;const puerts_1=require("puerts"),UE=require("ue"),EntityComponent_1=require("../../../../../../Core/Entity/EntityComponent"),RegisterComponent_1=require("../../../../../../Core/Entity/RegisterComponent"),Vector_1=require("../../../../../../Core/Utils/Math/Vector"),EventDefine_1=require("../../../../../Common/Event/EventDefine"),EventSystem_1=require("../../../../../Common/Event/EventSystem"),GlobalData_1=require("../../../../../GlobalData"),CharacterUnifiedStateTypes_1=require("../Abilities/CharacterUnifiedStateTypes"),CustomMovementDefine_1=require("./CustomMovementDefine"),KITE_MIN_ACCEL_DIST=300,KITE_MAX_ACCEL_DIST=900,KITE_MIN_ACCEL=1200,KITE_MAX_ACCEL=18e3,KITE_FRICTION=.98,KITE_FACING_LERP_SPEED=240,KITE_FACING_LERP_RATE=.9;let CharacterKiteComponent=class CharacterKiteComponent extends EntityComponent_1.EntityComponent{constructor(){super(...arguments),this.Gce=void 0,this.w1l=Vector_1.Vector.Create(),this.Die=void 0,this.Vul=0,this.Cgl=0,this.B1l=(0,puerts_1.$ref)(void 0),this.OnMoveStateChanged=(t,e)=>{t===CharacterUnifiedStateTypes_1.ECharMoveState.Kite&&(this.Die=void 0)}}static get Dependencies(){return[167]}KiteMove(t){var e,i;this.Die?.Valid&&this.Vul===this.Die.SplineMoveEndCount?(e=UE.KismetMathLibrary.WD_WorldToLocal(GlobalData_1.GlobalData.World,this.w1l.ToUeVector()),i=UE.KismetMathLibrary.WD_WorldToLocal(GlobalData_1.GlobalData.World,this.Die.HookLocation.ToUeVector()),UE.KuroMovementBPLibrary.KuroKite(t,this.Gce.CharacterMovement,e,i,KITE_MIN_ACCEL_DIST,KITE_MAX_ACCEL_DIST,KITE_MIN_ACCEL,KITE_MAX_ACCEL,KITE_FRICTION,this.B1l,KITE_FACING_LERP_SPEED,KITE_FACING_LERP_RATE),this.w1l.DeepCopy(this.Die.HookLocation)):(this.Cgl!==this.Die?.SplineMoveBrokenCount&&this.Entity.GetComponent(91)?.SetIsHookEndByInterrupt(!0),this.Gce?.CharacterMovement?.SetMovementMode(3))}OnInit(t){return!0}OnStart(){return this.Gce=this.Entity.GetComponent(167),EventSystem_1.EventSystem.AddWithTarget(this.Entity,EventDefine_1.EEventName.CharOnUnifiedMoveStateChanged,this.OnMoveStateChanged),!0}OnEnd(){return EventSystem_1.EventSystem.RemoveWithTarget(this.Entity,EventDefine_1.EEventName.CharOnUnifiedMoveStateChanged,this.OnMoveStateChanged),!0}EnterKite(t){return!(!t||!this.Gce?.CharacterMovement||(this.Die=t,this.Vul=t.SplineMoveEndCount,this.Cgl=t.SplineMoveBrokenCount,this.Gce.CharacterMovement.SetMovementMode(6,CustomMovementDefine_1.CUSTOM_MOVEMENTMODE_KITE),this.w1l.DeepCopy(this.Die.HookLocation),0))}};CharacterKiteComponent=__decorate([(0,RegisterComponent_1.RegisterComponent)(34)],CharacterKiteComponent),exports.CharacterKiteComponent=CharacterKiteComponent;
//# sourceMappingURL=CharacterKiteComponent.js.map