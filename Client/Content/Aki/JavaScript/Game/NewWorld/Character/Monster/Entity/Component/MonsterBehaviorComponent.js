
"use strict";var __decorate=this&&this.__decorate||function(e,t,i,s){var o,n=arguments.length,r=n<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,i,s);else for(var a=e.length-1;0<=a;a--)(o=e[a])&&(r=(n<3?o(r):3<n?o(t,i,r):o(t,i))||r);return 3<n&&r&&Object.defineProperty(t,i,r),r};Object.defineProperty(exports,"__esModule",{value:!0}),exports.MonsterBehaviorComponent=void 0;const UE=require("ue"),Protocol_1=require("../../../../../../Core/Define/Net/Protocol"),EntityComponent_1=require("../../../../../../Core/Entity/EntityComponent"),RegisterComponent_1=require("../../../../../../Core/Entity/RegisterComponent"),TimerSystem_1=require("../../../../../../Core/Timer/TimerSystem"),EventDefine_1=require("../../../../../Common/Event/EventDefine"),EventSystem_1=require("../../../../../Common/Event/EventSystem"),SkeletalMeshEffectContext_1=require("../../../../../Effect/EffectContext/SkeletalMeshEffectContext"),EffectSystem_1=require("../../../../../Effect/EffectSystem"),GlobalData_1=require("../../../../../GlobalData"),ModelManager_1=require("../../../../../Manager/ModelManager"),CombatMessage_1=require("../../../../../Module/CombatMessage/CombatMessage"),CharacterUnifiedStateTypes_1=require("../../../Common/Component/Abilities/CharacterUnifiedStateTypes"),MONSTER_ENTER_WUYINQU_EFFCT="/Game/Aki/Effect/DataAsset/Niagara/Common/Wuyinqu/DA_Fx_Wuyinqu_Ordinary_Origin.DA_Fx_Wuyinqu_Ordinary_Origin",ELITE_MONSTER_ENTER_WUYINQU_EFFCT="/Game/Aki/Effect/DataAsset/Niagara/Common/Wuyinqu/DA_Fx_Wuyinqu_Elite_Origin.DA_Fx_Wuyinqu_Elite_Origin";let MonsterBehaviorComponent=class MonsterBehaviorComponent extends EntityComponent_1.EntityComponent{constructor(){super(...arguments),this.Hte=void 0,this.Xte=void 0,this.N1t=void 0,this.S7a=void 0,this.Rne=0,this.y7a=0,this.tVr=void 0,this.Llt=!0,this.Kqr=(e,t)=>{var i;t!==CharacterUnifiedStateTypes_1.ECharPositionState.Water||this.Xte.HasTag(-1714966381)||(t=this.Hte.ActorLocationProxy,(i=Protocol_1.Aki.Protocol.A4n.create()).l8n=t,CombatMessage_1.CombatNet.Call(18603,this.Entity,i))},this.qtn=()=>{ModelManager_1.ModelManager.GameModeModel.IsMulti||this.tVr.SetEnableMovementSync(!1,"MonsterBehaviorComponent LeaveFight")},this.Ntn=(e,t)=>{!t||ModelManager_1.ModelManager.GameModeModel.IsMulti||this.tVr.SetEnableMovementSync(!0,"MonsterBehaviorComponent InFight")},this.E7a=(e,t)=>{if(t){var i,s,t=this.Entity?.GetComponent(3)?.SkeletalMesh;t&&((i=new SkeletalMeshEffectContext_1.SkeletalMeshEffectContext(this.Entity.Id)).SkeletalMeshComp=t,s=this.Llt?MONSTER_ENTER_WUYINQU_EFFCT:ELITE_MONSTER_ENTER_WUYINQU_EFFCT,this.y7a=EffectSystem_1.EffectSystem.SpawnEffect(GlobalData_1.GlobalData.World,t.GetSocketTransform(new UE.FName("Root")),s,"MonsterBehaviorComponent.DisableTag exist",i)),this.Rne=this.Entity.Disable("MonsterBehaviorComponent.DisableTag exist")}else if(0!==this.y7a&&(EffectSystem_1.EffectSystem.StopEffectById(this.y7a,"MonsterBehaviorComponent.DisableTag do not exist",!1),this.y7a=0),this.Entity.Enable(this.Rne,"MonsterBehaviorComponent.DisableTag do not exist"),!this.Llt){const o=this.Hte?.Actor?.GetComponentByClass(UE.SkeletalMeshComponent.StaticClass());o&&(o.SetVisibility(!1),TimerSystem_1.TimerSystem.Delay(()=>{o.SetVisibility(!0)},100))}}}OnStart(){return this.Hte=this.Entity.CheckGetComponent(3),this.Xte=this.Entity.CheckGetComponent(191),this.tVr=this.Entity.CheckGetComponent(60),EventSystem_1.EventSystem.AddWithTarget(this.Entity,EventDefine_1.EEventName.CharOnPositionStateChanged,this.Kqr),EventSystem_1.EventSystem.AddWithTarget(this.Entity,EventDefine_1.EEventName.AiTaskWanderForResetEnd,this.qtn),this.N1t=this.Xte.ListenForTagAddOrRemove(1996802261,this.Ntn),this.S7a=this.Xte.ListenForTagAddOrRemove(1681491134,this.E7a),this.Llt=0===this.Entity?.GetComponent(0)?.GetBaseInfo()?.Category?.MonsterMatchType,!0}OnActivate(){ModelManager_1.ModelManager.GameModeModel.IsMulti||this.tVr?.SetEnableMovementSync(!1,"MonsterBehaviorComponent OnActivate")}OnEnd(){return EventSystem_1.EventSystem.RemoveWithTarget(this.Entity,EventDefine_1.EEventName.CharOnPositionStateChanged,this.Kqr),EventSystem_1.EventSystem.RemoveWithTarget(this.Entity,EventDefine_1.EEventName.AiTaskWanderForResetEnd,this.qtn),this.N1t&&this.N1t.EndTask(),this.N1t=void 0,this.S7a&&(this.S7a.EndTask(),this.S7a=void 0),0!==this.y7a&&(EffectSystem_1.EffectSystem.StopEffectById(this.y7a,"MonsterBehaviorComponent.OnEnd",!0),this.y7a=0),!0}};MonsterBehaviorComponent=__decorate([(0,RegisterComponent_1.RegisterComponent)(80)],MonsterBehaviorComponent),exports.MonsterBehaviorComponent=MonsterBehaviorComponent;
//# sourceMappingURL=MonsterBehaviorComponent.js.map