
"use strict";var _a;Object.defineProperty(exports,"__esModule",{value:!0}),exports.PlayerVelocityController=void 0;const UE=require("ue"),Stats_1=require("../../../Core/Common/Stats"),ControllerBase_1=require("../../../Core/Framework/ControllerBase"),MathCommon_1=require("../../../Core/Utils/Math/MathCommon"),Vector_1=require("../../../Core/Utils/Math/Vector"),EventDefine_1=require("../../Common/Event/EventDefine"),EventSystem_1=require("../../Common/Event/EventSystem"),GlobalData_1=require("../../GlobalData"),ModelManager_1=require("../../Manager/ModelManager"),MAX_DELTA_TIME=5,HIGH_SPEED_SQUARED=64e4,IMPOSTER_UPDATE_BATCH="r.imp.UpdateBatch";class PlayerVelocityController extends ControllerBase_1.ControllerBase{static OnInit(){return this.DEa(),this.sCe(),super.OnInit()}static DEa(){this.REa=UE.KismetSystemLibrary.GetConsoleVariableIntValue(IMPOSTER_UPDATE_BATCH)}static OnClear(){return this.aCe(),super.OnClear()}static sCe(){EventSystem_1.EventSystem.Add(EventDefine_1.EEventName.WorldDoneAndCloseLoading,this.nye),EventSystem_1.EventSystem.Add(EventDefine_1.EEventName.BeforeLoadMap,this.SYi),EventSystem_1.EventSystem.Add(EventDefine_1.EEventName.TeleportStart,this.bpr),EventSystem_1.EventSystem.Add(EventDefine_1.EEventName.TeleportComplete,this.AEa)}static aCe(){EventSystem_1.EventSystem.Remove(EventDefine_1.EEventName.WorldDoneAndCloseLoading,this.nye),EventSystem_1.EventSystem.Remove(EventDefine_1.EEventName.BeforeLoadMap,this.SYi),EventSystem_1.EventSystem.Remove(EventDefine_1.EEventName.TeleportStart,this.bpr),EventSystem_1.EventSystem.Remove(EventDefine_1.EEventName.TeleportComplete,this.AEa)}static il(){this.UEa=!0,this.av()}static nl(){this.UEa=!1}static av(){this.BKs.DeepCopy(this.xEa()),this.PEa()}static PEa(){this.wEa.Set(0,0,0)}static OnTick(t){this.UEa&&this.BEa(.001*t)}static xEa(){var t=ModelManager_1.ModelManager.SceneTeamModel.GetCurrentEntity?.Entity?.GetComponent(3);return t?t.ActorLocationProxy:this.BKs}static BEa(t){var e;this.bEa.Start(),t<=0?this.PEa():t>MAX_DELTA_TIME?this.av():((e=this.xEa()).Subtraction(this.BKs,this.qEa),this.qEa.DivisionEqual(t),this.BKs.DeepCopy(e),e=MathCommon_1.MathCommon.Clamp(100*t,0,1),this.wEa.MultiplyEqual(1-e),this.qEa.MultiplyEqual(e),this.wEa.AdditionEqual(this.qEa)),this.GEa(),this.bEa.Stop()}static GEa(){var t=this.wEa.SizeSquared()>HIGH_SPEED_SQUARED;t!==this.tWo&&(this.tWo=t,this.OEa(),EventSystem_1.EventSystem.Emit(EventDefine_1.EEventName.OnHighSpeedModeChanged,this.tWo))}static OEa(){this.tWo?this.kEa(Math.floor(this.REa/2)):this.kEa(this.REa)}static kEa(t){this.NEa[0]=IMPOSTER_UPDATE_BATCH,this.NEa[1]=t,UE.KismetSystemLibrary.ExecuteConsoleCommand(GlobalData_1.GlobalData.World,this.NEa.join(" "))}static GetAvgVelocity(){return this.wEa}static IsHighSpeedMode(){return this.tWo}}exports.PlayerVelocityController=PlayerVelocityController,(_a=PlayerVelocityController).UEa=!1,PlayerVelocityController.BKs=Vector_1.Vector.Create(0,0,0),PlayerVelocityController.qEa=Vector_1.Vector.Create(0,0,0),PlayerVelocityController.wEa=Vector_1.Vector.Create(0,0,0),PlayerVelocityController.tWo=!1,PlayerVelocityController.REa=128,PlayerVelocityController.NEa=["",0],PlayerVelocityController.bEa=Stats_1.Stat.Create("PlayerVelocityController.CalculateVelocity"),PlayerVelocityController.nye=()=>{_a.il()},PlayerVelocityController.SYi=()=>{_a.nl()},PlayerVelocityController.bpr=()=>{_a.nl()},PlayerVelocityController.AEa=()=>{_a.il()};
//# sourceMappingURL=PlayerVelocityController.js.map