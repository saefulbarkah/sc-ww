
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const UE=require("ue"),Log_1=require("../../../../Core/Common/Log"),materialControllerStateHandleMap=new Map;class AnimNotifyStateAddMaterialControllerDataGroup extends UE.KuroAnimNotifyState{constructor(){super(...arguments),this.MaterialAssetData=void 0}K2_NotifyBegin(e,t,r){let a=-1;if(this.IsAllValid(e,t)&&(t=e.GetOwner())instanceof UE.TsBaseCharacter_C&&(t.CharRenderingComponent.CheckInit()||t.CharRenderingComponent.Init(t.RenderType),a=t.CharRenderingComponent.AddMaterialControllerDataGroup(this.MaterialAssetData)),0<=a){let t=materialControllerStateHandleMap.get(e);return t||(t=new Map,materialControllerStateHandleMap.set(e,t)),t.set(this,a),!0}return!1}K2_NotifyEnd(t,e){var r=materialControllerStateHandleMap.get(t);if(!r)return!0;var a=r.get(this);if(!a)return!0;r.delete(this),r.size||materialControllerStateHandleMap.delete(t);try{if(0<=a){var o=t.GetOwner();if(o instanceof UE.TsBaseCharacter_C)return o.CharRenderingComponent.RemoveMaterialControllerDataGroupWithEnding(a),!0}}catch{Log_1.Log.CheckWarn()&&Log_1.Log.Warn("RenderCharacter",26,"AnimNotifyStateAddMaterialControllerData移除特效失败",["Actor",t?.GetOwner()?.GetName()],["动画",e?.GetName()],["handleId",a])}return!1}IsAllValid(t,e){return UE.KismetSystemLibrary.IsValid(this.MaterialAssetData)?t&&UE.KismetSystemLibrary.IsValid(t)?UE.KismetSystemLibrary.IsValid(t.GetOwner())?t.GetOwner()instanceof UE.TsBaseCharacter_C||(Log_1.Log.CheckWarn()&&Log_1.Log.Warn("RenderCharacter",14,"错误：必须是TsBaseCharacter及其派生类调用",["Actor",t?.GetOwner()?.GetName()],["动画",e?.GetName()]),!1):(Log_1.Log.CheckError()&&Log_1.Log.Error("RenderCharacter",14,"错误：动画Owner不合法",["Actor",t?.GetOwner()?.GetName()],["动画",e?.GetName()]),!1):(Log_1.Log.CheckError()&&Log_1.Log.Error("RenderCharacter",14,"错误：动画Mesh不合法",["Actor",t?.GetOwner()?.GetName()],["动画",e?.GetName()]),!1):(Log_1.Log.CheckError()&&Log_1.Log.Error("RenderCharacter",14,"错误：特效DA不合法",["Actor",t?.GetOwner()?.GetName()],["动画",e?.GetName()]),!1)}GetNotifyName(){var t=this.MaterialAssetData.GetName();return t?"材质控制器组:"+UE.BlueprintPathsLibrary.GetBaseFilename(t,!0):"材质控制器组"}}exports.default=AnimNotifyStateAddMaterialControllerDataGroup;
//# sourceMappingURL=AnimNotifyStateAddMaterialControllerDataGroup.js.map