
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.LevelEventFocusOnMapMark=void 0;const Log_1=require("../../../Core/Common/Log"),IAction_1=require("../../../UniverseEditor/Interface/IAction"),EventDefine_1=require("../../Common/Event/EventDefine"),EventSystem_1=require("../../Common/Event/EventSystem"),ConfigManager_1=require("../../Manager/ConfigManager"),ControllerHolder_1=require("../../Manager/ControllerHolder"),ModelManager_1=require("../../Manager/ModelManager"),LevelGeneralBase_1=require("../LevelGeneralBase");class LevelEventFocusOnMapMark extends LevelGeneralBase_1.LevelEventBase{constructor(){super(...arguments),this.iU_=void 0,this.rU_=void 0,this.Uct=e=>{6===e.Type&&e.TreeConfigId===this.iU_&&this.rU_&&this.fu_(this.rU_)}}ExecuteNew(e,t,n){var r=e;if(r)switch(r.MapMarkType.Type){case IAction_1.EMapMarkType.Custom:this.pu_(r.MapMarkType);break;case IAction_1.EMapMarkType.Quest:this.fu_(r.MapMarkType);break;default:Log_1.Log.CheckError()&&Log_1.Log.Error("LevelEvent",63,"[LevelEventFocusOnMapMark]未定义类型",["MapMarkType",r.MapMarkType.Type]),this.Finish()}else this.Finish()}pu_(e){var e=e.MarkId,t=ConfigManager_1.ConfigManager.MapConfig.SearchMarkConfig(e);void 0===t?Log_1.Log.CheckError()&&Log_1.Log.Error("LevelEvent",63,"[LevelEventFocusOnMapMark]HandleCustomMapFocus->找不到对应的标记配置",["markId",e]):(e={MarkId:e,MarkType:t.ObjectType},ControllerHolder_1.ControllerHolder.WorldMapController.OpenView(2,!1,e)),this.Finish()}OnFailure(){this.kre()}OnFinish(){this.kre()}Ore(){EventSystem_1.EventSystem.Has(EventDefine_1.EEventName.AfterLogicTreeChildQuestNodeStatusChange,this.Uct)||EventSystem_1.EventSystem.Add(EventDefine_1.EEventName.AfterLogicTreeChildQuestNodeStatusChange,this.Uct)}kre(){EventSystem_1.EventSystem.Has(EventDefine_1.EEventName.AfterLogicTreeChildQuestNodeStatusChange,this.Uct)&&EventSystem_1.EventSystem.Remove(EventDefine_1.EEventName.AfterLogicTreeChildQuestNodeStatusChange,this.Uct)}OnReset(){this.iU_=void 0}fu_(e){const t=e.QuestId;var n=ModelManager_1.ModelManager.MapModel.GetMarkByQuestId(t);void 0===n?void 0!==this.rU_?(Log_1.Log.CheckError()&&Log_1.Log.Error("LevelEvent",63,"[LevelEventFocusOnMapMark]HandleQuestMapFocus->找不到对应的标记配置",["markId",t]),this.Finish()):(this.iU_=t,this.rU_=e,this.Ore()):(e={MarkId:n.MarkId,MarkType:n.MarkType},ControllerHolder_1.ControllerHolder.WorldMapController.OpenView(2,!1,e,()=>{EventSystem_1.EventSystem.Emit(EventDefine_1.EEventName.WorldMapOpenedForQuestMapFocus,t)}),this.Finish())}}exports.LevelEventFocusOnMapMark=LevelEventFocusOnMapMark;
//# sourceMappingURL=LevelEventFocusOnMapMark.js.map