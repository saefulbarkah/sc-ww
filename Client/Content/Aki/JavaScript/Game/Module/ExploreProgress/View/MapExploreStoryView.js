
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.MapExploreStoryView=void 0;const UE=require("ue"),UiViewBase_1=require("../../../Ui/Base/UiViewBase"),PopupCaptionItem_1=require("../../../Ui/Common/PopupCaptionItem"),GenericScrollViewNew_1=require("../../Util/ScrollView/GenericScrollViewNew"),MapAreaOnlyShowItem_1=require("./MapAreaOnlyShowItem"),MapExploreStoryItem_1=require("./MapExploreStoryItem");class MapExploreStoryView extends UiViewBase_1.UiViewBase{constructor(){super(...arguments),this.vOl=void 0,this.zJa=void 0,this.xqe=void 0,this.MOl=void 0,this.wnl=-1,this.pjl=[],this.Zkl=()=>{this.CloseMe()}}OnRegisterComponent(){this.ComponentRegisterInfos=[[0,UE.UIItem],[1,UE.UIScrollViewWithScrollbarComponent],[2,UE.UIItem],[3,UE.UIItem],[4,UE.UIText],[5,UE.UIText]]}async OnBeforeStartAsync(){this.vOl=this.OpenParam,this.zJa=new PopupCaptionItem_1.PopupCaptionItem(this.GetItem(0)),this.zJa.SetCloseCallBack(this.Zkl),this.zJa.SetHelpBtnActive(!1),this.xqe=new GenericScrollViewNew_1.GenericScrollViewNew(this.GetScrollViewWithScrollbar(1),()=>new MapExploreStoryItem_1.MapExploreStoryItem),this.pjl=this.vOl.AreaData.GetStoryList(),await this.xqe.RefreshByDataAsync(this.pjl,!0),this.wnl=this.pjl.findIndex(i=>!!i.IsNewOpen),this.xqe.LateScrollTo(this.xqe.GetItemByIndex(this.wnl)),this.MOl=new MapAreaOnlyShowItem_1.MapAreaOnlyShowItem;var i=this.GetItem(3).GetOwner();await this.MOl.CreateThenShowByActorAsync(i)}OnBeforeShow(){var i=this.vOl.AreaData,t=i.GetStoryViewTitle(),t=(this.GetText(5)?.SetText(t),i.GetProgress());this.GetText(4)?.SetText(t+"%"),this.MOl?.Refresh(i.GetIconPercentDataAreaStory())}OnAfterPlayStartSequence(){if(0<=this.wnl)for(let i=this.wnl;i<this.pjl.length;i++)this.pjl[i].IsNewOpen&&this.xqe.GetScrollItemByIndex(i)?.PlayNewOpenAnim()}OnBeforeDestroy(){this.vOl?.AreaData.SaveLocalAreaStoryProgress(),this.vOl?.AreaData.SaveLocalIconPercentAreaStory(),this.zJa=void 0,this.xqe=void 0,this.MOl=void 0}}exports.MapExploreStoryView=MapExploreStoryView;
//# sourceMappingURL=MapExploreStoryView.js.map