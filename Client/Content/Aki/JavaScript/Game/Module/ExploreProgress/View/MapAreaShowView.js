
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.MapAreaShowView=void 0;const UE=require("ue"),Info_1=require("../../../../Core/Common/Info"),Log_1=require("../../../../Core/Common/Log"),Time_1=require("../../../../Core/Common/Time"),CommonParamById_1=require("../../../../Core/Define/ConfigCommon/CommonParamById"),EventDefine_1=require("../../../Common/Event/EventDefine"),EventSystem_1=require("../../../Common/Event/EventSystem"),ModelManager_1=require("../../../Manager/ModelManager"),UiViewBase_1=require("../../../Ui/Base/UiViewBase"),CommonTabComponentData_1=require("../../Common/TabComponent/CommonTabComponentData"),CommonTabData_1=require("../../Common/TabComponent/CommonTabData"),CommonTabTitleData_1=require("../../Common/TabComponent/CommonTabTitleData"),TabComponent_1=require("../../Common/TabComponent/TabComponent"),TabComponentWithCaptionItem_1=require("../../Common/TabComponent/TabComponentWithCaptionItem"),LoopScrollView_1=require("../../Util/ScrollView/LoopScrollView"),MapAreaShowCountryItem_1=require("./MapAreaShowCountryItem"),MapAreaShowItem_1=require("./MapAreaShowItem"),MapAreaShowTabItem_1=require("./MapAreaShowTabItem");class MapAreaShowView extends UiViewBase_1.UiViewBase{constructor(){super(...arguments),this.Dkl=void 0,this.Ivt=void 0,this.Akl=0,this.ZZt=void 0,this.L6e=void 0,this.AreaScroll=void 0,this.Pkl=void 0,this.xkl=void 0,this.wkl=0,this.vOl=void 0,this.R6e=()=>{return new MapAreaShowCountryItem_1.MapAreaShowCountryItem},this.pqe=e=>{this.L6e=Time_1.Time.Now,this.Akl=e,Log_1.Log.CheckDebug()&&Log_1.Log.Debug("Map",69,"触发选择",["index",this.Akl]),this.Bkl()},this.bkl=e=>{e=this.Dkl[e];return new CommonTabData_1.CommonTabData(e.Icon,new CommonTabTitleData_1.CommonTabTitleData(e.TitleId,e))},this.lyt=()=>{this.CloseMe()},this.Bpt=()=>!!Info_1.Info.IsInGamepad()||!this.L6e||Time_1.Time.Now-this.L6e>=this.ZZt,this.qkl=()=>{var e,t;let i=!1;for([e,t]of this.Pkl.GetTabItemMap())t.UpdateView(this.xkl[e]),this.xkl[e].IsNoneState||(i=!0);this.Pkl.SelectToggleByIndex(0,!0),this.GetItem(3).SetUIActive(i)},this.fqe=()=>{return new MapAreaShowTabItem_1.MapAreaShowTabItem},this.Gkl=e=>{this.wkl=e,this.kkl()},this.KPn=()=>{return new MapAreaShowItem_1.MapAreaShowItem},this.rOl=e=>{this.vOl?.OnClickArea?.(e)}}OnRegisterComponent(){this.ComponentRegisterInfos=[[0,UE.UIItem],[1,UE.UILoopScrollViewComponent],[2,UE.UIItem],[3,UE.UIItem],[4,UE.UIHorizontalLayout],[5,UE.UIItem]]}async OnBeforeStartAsync(){this.Dkl=ModelManager_1.ModelManager.ExploreProgressModel.GetExploreCountryDataList(),await this.InitCommonOneTab()}OnStart(){this.Ivt.SetHelpButtonShowState(!1)}OnAddEventListener(){EventSystem_1.EventSystem.Add(EventDefine_1.EEventName.MapAreaShowClickArea,this.rOl)}OnRemoveEventListener(){EventSystem_1.EventSystem.Remove(EventDefine_1.EEventName.MapAreaShowClickArea,this.rOl)}OnBeforeShow(){this.vOl=this.OpenParam;let t=0;if(this.vOl){Log_1.Log.CheckDebug()&&Log_1.Log.Debug("Map",69,"params",["国家id",this.vOl.CountryId],["区域ID",this.vOl.AreaId]);for(let e=0;e<this.Dkl.length;e++){var i=this.Dkl[e];if(this.vOl.CountryId===i.CountryId){t=e;break}}}this.Ivt.SelectToggleByIndex(t,!0)}OnBeforeDestroy(){this.Pkl&&(this.Pkl.Destroy(),this.Pkl=void 0)}async InitCommonOneTab(){this.ZZt=CommonParamById_1.configCommonParamById.GetIntConfig("panel_interval_time");var e=new CommonTabComponentData_1.CommonTabComponentData(this.R6e,this.pqe,this.bkl),e=(this.Ivt=new TabComponentWithCaptionItem_1.TabComponentWithCaptionItem(this.GetItem(0),e,this.lyt),this.Ivt.SetCanChange(this.Bpt),this.Dkl.length),e=this.Ivt.CreateTabItemDataByLength(e);await this.Ivt.RefreshTabItemAsync(e)}Bkl(){this.Pkl||(this.Pkl=new TabComponent_1.TabComponent(this.GetItem(3),this.fqe,this.Gkl,this.GetItem(5)));var e=this.Dkl[this.Akl],e=(this.xkl=e.GetStateDataList(),this.xkl.length);this.Pkl.RefreshTabItemByLength(e,this.qkl)}kkl(){this.RefreshLoopScrollView()}RefreshLoopScrollView(){var e=this.GetLoopScrollViewComponent(1),e=(this.AreaScroll||(this.AreaScroll=new LoopScrollView_1.LoopScrollView(e,this.GetItem(2).GetOwner(),this.KPn,!0)),this.xkl[this.wkl].ExploreAreaDataList);this.AreaScroll.RefreshByData(e,!1,()=>{},!0)}}exports.MapAreaShowView=MapAreaShowView;
//# sourceMappingURL=MapAreaShowView.js.map