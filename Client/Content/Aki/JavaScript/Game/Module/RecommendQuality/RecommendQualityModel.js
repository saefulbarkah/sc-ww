
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.RecommendQualityModel=void 0;const ModelBase_1=require("../../../Core/Framework/ModelBase"),LocalStorage_1=require("../../Common/LocalStorage"),LocalStorageDefine_1=require("../../Common/LocalStorageDefine"),GameSettingsDeviceRender_1=require("../../GameSettings/GameSettingsDeviceRender"),GameSettingsManager_1=require("../../GameSettings/GameSettingsManager"),GameSettingsUtils_1=require("../../GameSettings/GameSettingsUtils"),CloudGameManager_1=require("../../Manager/CloudGameManager"),ConfigManager_1=require("../../Manager/ConfigManager"),UiManager_1=require("../../Ui/UiManager"),MenuTool_1=require("../Menu/MenuTool");class RecommendQualityModel extends ModelBase_1.ModelBase{constructor(){super(...arguments),this.QualityRangeMap=void 0,this.nml=void 0,this.sml=0,this.aml=!1,this.vml=!1,this.Mml=4}OnInit(){return CloudGameManager_1.CloudGameManager.IsCloudGame?this.aml=!0:(this.aml=LocalStorage_1.LocalStorage.GetGlobal(LocalStorageDefine_1.ELocalStorageGlobalKey.IsFinishRecommendQuality,!1),this.aml||(this.InitQualityRangeMap(),this.InitQualityList()),!0)}OnClear(){return!0}InitQualityRangeMap(){this.QualityRangeMap=new Map([[0,[0,1,2]],[1,[1,2,3]],[2,[2,3]]])}InitQualityList(){var e=GameSettingsDeviceRender_1.GameSettingsDeviceRender.GetQualityRange(),e=this.QualityRangeMap?.get(e);if(e){this.nml=[];const n=(ConfigManager_1.ConfigManager.MenuBaseConfig?.GetMenuConfigListByFunctionId(10))?.find(e=>MenuTool_1.MenuTool.CheckPlatform(e)),r=n?.OptionsName??[],o=GameSettingsDeviceRender_1.GameSettingsDeviceRender.GetRecommendQualityLv();r.pop(),e.forEach((e,t)=>{var i="T_LoginSetQuality"+(e+1),i=ConfigManager_1.ConfigManager.UiResourceConfig.GetResourcePath(i),a=n?.OptionsValue.indexOf(e)??0,a={Quality:e,Name:r[a]??r[0],IsRecommend:o===e,Bg:i};this.nml.push(a),a.IsRecommend&&(this.sml=t)})}}GetQualityList(){return this.nml??[]}GetRecommendQualityIndex(){return this.sml}ApplyQuality(){return!!this.vml&&(this.vml=!1,GameSettingsUtils_1.GameSettingsUtils.SetIsCustomImageQuality(!1),GameSettingsManager_1.GameSettingsManager.SetApplySave(10,this.Mml),!0)}SaveApply(e){this.vml=!0,this.Mml=e}FinishRecommendQualityShow(){LocalStorage_1.LocalStorage.SetGlobal(LocalStorageDefine_1.ELocalStorageGlobalKey.IsFinishRecommendQuality,!0)}CheckOpenRecommendQuality(){this.aml?UiManager_1.UiManager.CloseView("CreateCharacterView"):UiManager_1.UiManager.OpenView("RecommendQualityView")}}exports.RecommendQualityModel=RecommendQualityModel;
//# sourceMappingURL=RecommendQualityModel.js.map