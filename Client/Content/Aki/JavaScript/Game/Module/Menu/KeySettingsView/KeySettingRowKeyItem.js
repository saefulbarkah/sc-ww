
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.KeySettingRowKeyItem=void 0;const UE=require("ue"),Log_1=require("../../../../Core/Common/Log"),StringUtils_1=require("../../../../Core/Utils/StringUtils"),UiPanelBase_1=require("../../../Ui/Base/UiPanelBase"),LevelSequencePlayer_1=require("../../Common/LevelSequencePlayer"),LguiUtil_1=require("../../Util/LguiUtil");class KeySettingRowKeyItem extends UiPanelBase_1.UiPanelBase{constructor(){super(...arguments),this.uPi=void 0,this.oxi=0,this.SPi=void 0,this.r2n=void 0,this.rxi=i=>{1===i&&this.uPi&&this.SPi&&this.SPi(this.uPi,this)}}OnRegisterComponent(){this.ComponentRegisterInfos=[[0,UE.UIText],[1,UE.UIExtendToggle],[2,UE.UIText],[3,UE.UIItem],[4,UE.UIText],[5,UE.UISprite],[6,UE.UISprite],[7,UE.UISprite],[8,UE.UIItem]],this.BtnBindInfo=[[1,this.rxi]]}OnStart(){this.r2n=new LevelSequencePlayer_1.LevelSequencePlayer(this.GetItem(8))}OnBeforeDestroy(){this.ClearData(),this.SPi=void 0,this.r2n?.Clear(),this.r2n=void 0}ClearData(){this.uPi=void 0,this.oxi=0}BindOnWaitInput(i){this.SPi=i}Refresh(i,t){2===i.GetRowType()&&(this.uPi=i,this.oxi=t,this.Nft(),this.nxi(),this.sxi(),this.Rxt(),this.SetDetailItemVisible(i.IsExpandDetail))}Nft(){var i=this.GetText(0),t=this.uPi.GetSettingName();StringUtils_1.StringUtils.IsEmpty(t)?i.SetText(this.uPi.GetActionOrAxisName()):LguiUtil_1.LguiUtil.SetLocalTextNew(i,t)}nxi(){var t=this.uPi.ButtonTextId;if(t&&!StringUtils_1.StringUtils.IsBlank(t))LguiUtil_1.LguiUtil.SetLocalTextNew(this.GetText(2),t);else{let i="+";var e,s,h,r,n,t=this.uPi.BothActionName,t=(t&&1<t.length&&(i="/"),this.uPi.GetCurrentKeyNameRichText(this.oxi,i));t.length<=0&&(n=this.uPi.FindCombinationActionBinding(),e=this.uPi.CombinationAxisBinding,s=this.uPi.ActionBinding,h=this.uPi.AxisBinding,s?.GetKeyNameList(s=[]),h?.GetKeyNameList(h=[]),r=new Map,n?.GetKeyMap(r),n=new Map,e?.GetKeyMap(n),Log_1.Log.CheckInfo())&&Log_1.Log.Info("InputSettings",8,"刷新按键设置项时，按键名称为空",["ActionOrAxisName",this.uPi.GetActionOrAxisName()],["IsActionOrAxis",this.uPi.IsActionOrAxis],["ActionBindingKeys",s],["AxisBindingKeys",h],["combinationActionBindingKeyMap",r],["combinationAxisBindingKeyMap",r]),this.GetText(2)?.SetText(t)}}sxi(){var i=this.uPi.DetailTextId;StringUtils_1.StringUtils.IsEmpty(i)?this.GetSprite(5)?.SetUIActive(!1):(this.GetSprite(5)?.SetUIActive(!0),LguiUtil_1.LguiUtil.SetLocalTextNew(this.GetText(4),i))}Rxt(){var i=this.uPi.IsLock;this.GetSprite(6)?.SetUIActive(i),this.GetButton(1)?.SetSelfInteractive(!i)}SetSelected(i){this.GetSprite(7)?.SetUIActive(i),this.GetExtendToggle(1)?.SetToggleState(i?1:0,!1),this.GetText(2)?.SetUIActive(!i),this.GetItem(8)?.SetUIActive(i),i?this.r2n.PlayLevelSequenceByName("Loop"):this.r2n.StopCurrentSequence()}SetDetailItemVisible(i){var t,e=this.GetItem(3);!this.uPi||(t=this.uPi.DetailTextId,StringUtils_1.StringUtils.IsEmpty(t))?e.SetUIActive(!1):(e.SetUIActive(i),this.uPi.IsExpandDetail=i)}}exports.KeySettingRowKeyItem=KeySettingRowKeyItem;
//# sourceMappingURL=KeySettingRowKeyItem.js.map