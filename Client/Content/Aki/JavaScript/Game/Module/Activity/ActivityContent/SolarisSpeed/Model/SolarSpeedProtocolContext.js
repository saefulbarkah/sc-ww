
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.SolarSpeedProtocolContext=void 0;const Log_1=require("../../../../../../Core/Common/Log"),Protocol_1=require("../../../../../../Core/Define/Net/Protocol"),ActivityData_1=require("../../../ActivityData");var Proto_ActivityTaskState=Protocol_1.Aki.Protocol.I$s;const ModelManager_1=require("../../../../../Manager/ModelManager");class SolarSpeedProtocolContext extends ActivityData_1.ActivityBaseData{constructor(t){super(),this.i5l=void 0,this.I3_=new Map,this.T3_=new Map,this.CurrentRankPointsCache=0,this.CurrentDistancePointsCache=0,this.PlayerSettleMsgCache=new Map,this.i5l=t}Dispose(){this.I3_.clear(),this.T3_.clear()}PhraseEx(t){t=t.JN_;t&&this.ZVa(t)}GetExDataRedPointShowState(){return this.i5l.HasRewardRedDot||this.i5l.HasLevelRedDot}ZVa(t){Log_1.Log.CheckDebug()&&Log_1.Log.Debug("SolarSpeed",64,"解析联机跑酷活动信息",["data",t]),this.I3_.clear(),this.T3_.clear();for(const e of t.e3_)this.I3_.set(e.lG_,e);if(void 0!==t.t3_)for(const r of t.t3_.E$s)this.T3_.set(r.s5n,r)}ParseTeamParkourTaskNotify(t){Log_1.Log.CheckDebug()&&Log_1.Log.Debug("SolarSpeed",64,"解析联机跑酷活动任务数据",["msg",t]);t=t.T$s;void 0!==t&&this.T3_.set(t.s5n,t)}ParseTeamParkourSettleNotify(t){Log_1.Log.CheckDebug()&&Log_1.Log.Debug("SolarSpeed",64,"解析联机跑酷结算信息",["msg",t]),this.ResetTeamParkourSettleCache();var e,r,o=ModelManager_1.ModelManager.PlayerInfoModel.GetId();for(const s of t.a3_)this.PlayerSettleMsgCache.set(s.W5n,s),o===s.W5n&&(this.CurrentRankPointsCache=s.n3_,this.CurrentDistancePointsCache=s.s3_,void 0!==(e=this.I3_.get(t.lG_)))&&((0===e.ZN_||s.ZN_<e.ZN_)&&(e.ZN_=s.ZN_),(r=s.n3_+s.s3_)>e.SMs&&(e.SMs=r),0===e.s$_||0!==s.i3_&&s.i3_<e.s$_)&&(e.s$_=s.i3_)}ResetTeamParkourSettleCache(){this.CurrentRankPointsCache=0,this.CurrentDistancePointsCache=0,this.PlayerSettleMsgCache.clear()}GetScoreById(t){return this.I3_.get(t)?.SMs??0}GetRankingById(t){return this.I3_.get(t)?.ZN_??0}GetStartTime(t){return this.I3_.get(t)?.Mps??0}GetLapRecord(t){return this.I3_.get(t)?.s$_??0}GetCurrentProgressById(t){return this.T3_.get(t)?.lMs??0}GetCurrentProgressTargetById(t){return this.T3_.get(t)?.j6n??0}GetTaskStateById(t){return this.T3_.get(t)?.H6n}SetTaskStateRewardedById(t){t=this.T3_.get(t);void 0!==t&&(t.H6n=Proto_ActivityTaskState.Proto_ActivityTaskTaken)}}exports.SolarSpeedProtocolContext=SolarSpeedProtocolContext;
//# sourceMappingURL=SolarSpeedProtocolContext.js.map