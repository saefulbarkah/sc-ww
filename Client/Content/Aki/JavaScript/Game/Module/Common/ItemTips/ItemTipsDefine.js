
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.TipsCardData=exports.TipsOverPowerData=exports.TipsCharacterData=exports.TipsVisionData=exports.TipsWeaponData=exports.TipsMaterialData=exports.ItemTipsData=void 0;const MultiTextLang_1=require("../../../../Core/Define/ConfigQuery/MultiTextLang"),PhantomRarityByRare_1=require("../../../../Core/Define/ConfigQuery/PhantomRarityByRare"),Protocol_1=require("../../../../Core/Define/Net/Protocol"),StringUtils_1=require("../../../../Core/Utils/StringUtils"),TimeUtil_1=require("../../../Common/TimeUtil"),ConfigManager_1=require("../../../Manager/ConfigManager"),ControllerHolder_1=require("../../../Manager/ControllerHolder"),ModelManager_1=require("../../../Manager/ModelManager"),PayShopGoods_1=require("../../PayShop/PayShopData/PayShopGoods"),PayShopGoodsData_1=require("../../PayShop/PayShopData/PayShopGoodsData"),VisionDetailDescComponent_1=require("../../Phantom/Vision/View/VisionDetailDescComponent"),VisionDetailInfoComponent_1=require("../../Phantom/Vision/View/VisionDetailInfoComponent"),SkipTaskManager_1=require("../../SkipInterface/SkipTaskManager");class ItemTipsData{constructor(t,e,i){this.ItemType=0,this.GetWayData=void 0,this.LimitTimeTxt=void 0,this.CanClickLockButton=t=>!0,this.UpdateShowNumCallback=void 0,this.IsShowNumTextCallback=void 0;var a=ConfigManager_1.ConfigManager.InventoryConfig.GetItemConfigData(t),o=(this.IncId=e||0,this.ConfigId=t,this.Title=a.Name,this.QualityId=a.QualityId,[]);if(a.ItemAccess&&0<a.ItemAccess?.length)for(const r of a.ItemAccess){var s=ConfigManager_1.ConfigManager.GetWayConfig.GetConfigById(r);s&&ModelManager_1.ModelManager.SkipInterfaceModel.CheckAccessPathCondition(r)&&(s={Id:r,Type:s?.Type,Text:s?.Description,SortIndex:s?.SortIndex,Function:()=>{SkipTaskManager_1.SkipTaskManager.RunByConfigId(r,t)}},o.push(s))}this.GetWayData=o}CanDeprecate(){var t;return!(this.IncId<=0)&&void 0!==(t=ModelManager_1.ModelManager.InventoryModel?.GetAttributeItemData(this.IncId))&&t.CanDeprecate()}}class TipsMaterialData extends(exports.ItemTipsData=ItemTipsData){constructor(t,e){super(t,e),this.FunctionSpritePath=void 0,this.ItemType=0;var i=ConfigManager_1.ConfigManager.InventoryConfig.GetItemConfigData(t),a=(this.MaterialType=i.TypeDescription,this.FunctionSpritePath=this.cxt(i?.ItemBuffType),ModelManager_1.ModelManager.InventoryModel.GetItemCountByConfigId(t,e)),a=(this.Num=a,this.TxtEffect=i.AttributesDescription,this.TxtDescription=i.BgDescription,ModelManager_1.ModelManager.InventoryModel.GetCommonItemData(t,e));a?.IsLimitTimeItem()&&(i=a.GetEndTime(),t=TimeUtil_1.TimeUtil.GetDataFromTimeStamp(i*TimeUtil_1.TimeUtil.Millisecond),e=MultiTextLang_1.configMultiTextLang.GetLocalTextNew("Text_ItemExpired_text"),this.LimitTimeTxt=StringUtils_1.StringUtils.Format(e,t.Month,t.Day,t.Hour+":"+t.Minute))}cxt(t){var e=ModelManager_1.ModelManager.MediumItemGridModel;switch(t){case 0:break;case 1:return e.AttackBuffSpritePath;case 2:return e.DefenseBuffSpritePath;case 3:return e.RestoreHealthBuffSpritePath;case 4:return e.RechargeBuffSpritePath;case 5:return e.ResurrectionBuffSpritePath;case 6:return e.ExploreBuffSpritePath}}}exports.TipsMaterialData=TipsMaterialData;class TipsWeaponData extends ItemTipsData{constructor(t,e){super(t,e),this.WeaponType="",this.WeaponLevel=0,this.WeaponLimitLevel=0,this.BreachLevel=0,this.BreachMaxLevel=0,this.WeaponStage=0,this.WeaponSkillName="",this.WeaponEffect="",this.WeaponEffectParam=void 0,this.WeaponDescription="",this.AttributeData=void 0,this.IsEquip=!1,this.EquippedId=void 0;var i,a,o,s,r,n=ModelManager_1.ModelManager.InventoryModel.GetAttributeItemData(e),n=e?n.GetConfig():ConfigManager_1.ConfigManager.InventoryConfig.GetWeaponItemConfig(t);void 0!==n&&(e=(t=e?ModelManager_1.ModelManager.WeaponModel.GetWeaponDataByIncId(e):void 0)?t.GetWeaponConfig():ConfigManager_1.ConfigManager.WeaponConfig.GetWeaponConfigByItemId(n.ItemId),n=t?t.GetBreachLevel():0,s=t?t.GetResonanceLevel():1,i=t?t.GetBreachConfig():ConfigManager_1.ConfigManager.WeaponConfig.GetWeaponBreach(e.BreachId,n),o=e.BreachId,a=ConfigManager_1.ConfigManager.WeaponConfig.GetWeaponResonanceConfig(e.ResonId,s),this.ItemType=1,this.WeaponType=ConfigManager_1.ConfigManager.WeaponConfig.GetWeaponTypeName(e.WeaponType),r=t?t.GetLevel():1,i=i.LevelLimit,this.WeaponLevel=r,this.WeaponLimitLevel=i,this.BreachLevel=n,i=ModelManager_1.ModelManager.WeaponModel.GetWeaponBreachMaxLevel(o),this.BreachMaxLevel=i,this.WeaponStage=s,this.WeaponSkillName=a.Name,this.WeaponEffect=e.Desc,o=ModelManager_1.ModelManager.WeaponModel.GetWeaponConfigDescParams(e,s),this.WeaponEffectParam=o,this.WeaponDescription=e.AttributesDescription,i=[],a=e.FirstPropId.Id,s=ConfigManager_1.ConfigManager.PropertyIndexConfig.GetPropertyIndexInfo(a),o=ModelManager_1.ModelManager.WeaponModel.GetCurveValue(e.FirstCurve,e.FirstPropId.Value,r,n),a={Id:a,IsMainAttribute:!0,Name:s.Name,IconPath:s.Icon,Value:o,IsRatio:e.FirstPropId.IsRatio},o=e.SecondPropId.Id,s=ConfigManager_1.ConfigManager.PropertyIndexConfig.GetPropertyIndexInfo(o),r=ModelManager_1.ModelManager.WeaponModel.GetCurveValue(e.SecondCurve,e.SecondPropId.Value,r,n),n={Id:o,IsMainAttribute:!0,Name:s.Name,IconPath:s.Icon,Value:r,IsRatio:e.SecondPropId.IsRatio},i.push(a),i.push(n),this.AttributeData=i,t)&&(this.EquippedId=t.GetRoleId(),this.IsEquip=0!==this.EquippedId)}}exports.TipsWeaponData=TipsWeaponData;class TipsVisionData extends ItemTipsData{constructor(e,i,a){super(e,i),this.VisionId=0,this.VisionType="",this.Cost=0,this.UpgradeLevel="",this.MainSkillText="",this.MainSkillParams=void 0,this.SkillUniqueText=void 0,this.SkillUniqueTextParam=void 0,this.SkillUniqueRoleId=void 0,this.AttributeData=void 0,this.IsEquip=!1,this.EquippedId=void 0;let t=this.VisionDetailInfoComponentData=void 0;t=a instanceof Protocol_1.Aki.Protocol.t5s?ModelManager_1.ModelManager.InventoryModel.GetPhantomItemDataByPhantomItem(a):ModelManager_1.ModelManager.InventoryModel.GetAttributeItemData(i);var e=ConfigManager_1.ConfigManager.InventoryConfig.GetPhantomItemConfig(e),o=i?t.GetConfig():e;if(void 0!==o){var s=ModelManager_1.ModelManager.PhantomBattleModel;let t=void 0;a=(t=a instanceof Protocol_1.Aki.Protocol.t5s?ModelManager_1.ModelManager.PhantomBattleModel.GetPhantomBattleDataByPhantomItem(a):i?s.GetPhantomBattleData(i):void 0)?t.GetPhantomLevel():0,s=t?t.GetQuality():1,o=(this.ItemType=2,this.VisionId=o.MonsterId,o.Rarity),o=(this.VisionType=PhantomRarityByRare_1.configPhantomRarityByRare.GetConfig(o).Desc,this.Cost=ConfigManager_1.ConfigManager.PhantomBattleConfig.GetPhantomRareConfig(o).Cost,ConfigManager_1.ConfigManager.TextConfig.GetTextById("VisionLevel"));this.UpgradeLevel=StringUtils_1.StringUtils.Format(o,a.toString());const l=new VisionDetailInfoComponent_1.VisionDetailInfoComponentData;var o=ConfigManager_1.ConfigManager.PhantomBattleConfig,r=(e&&!t&&(e=e.SkillId,g=o.GetPhantomSkillBySkillId(e),this.MainSkillText=g.DescriptionEx,this.MainSkillParams=o.GetPhantomSkillDescExByPhantomSkillIdAndQuality(e,s),VisionDetailDescComponent_1.VisionDetailDesc.ConvertVisionSkillDescToDescData(g,a,!0,!0,s).forEach(t=>{l.AddDescData(t)})),[]),o=t?.GetMainPropShowAttributeList(1);if(void 0!==o)for(const d of o){var n=ConfigManager_1.ConfigManager.PropertyIndexConfig.GetPropertyIndexInfo(d.Id),n={Id:d.Id,IsMainAttribute:!0,Name:n.Name,IconPath:n.Icon,Value:d.BaseValue,IsRatio:d.IsRatio};r.push(n)}e=t?.GetSubPropShowAttributeList(1);if(void 0!==e)for(const p of e){var h=ConfigManager_1.ConfigManager.PropertyIndexConfig.GetPropertyIndexInfo(p.Id),h={Id:p.Id,IsMainAttribute:!1,Name:h.Name,IconPath:h.Icon,Value:p.BaseValue,IsRatio:p.IsRatio};r.push(h)}this.AttributeData=r;var g=ControllerHolder_1.ControllerHolder.PhantomBattleController.GetEquipRole(i),a=(g&&(this.EquippedId=g,this.IsEquip=0!==this.EquippedId),(l.DataBase=t)?.GetPreviewShowFetterList(-1,0));t&&VisionDetailDescComponent_1.VisionDetailDesc.ConvertVisionSkillDescToDescData(t?.GetNormalSkillConfig(),t.GetPhantomLevel(),!0,!0,s).forEach(t=>{l.AddDescData(t)}),a&&VisionDetailDescComponent_1.VisionDetailDesc.ConvertVisionFetterDataToDetailDescData(a,!1).forEach(t=>{l.AddDescData(t)}),this.VisionDetailInfoComponentData=l}}}exports.TipsVisionData=TipsVisionData;class TipsCharacterData extends ItemTipsData{constructor(t,e){super(t,e),this.mxt="",this.Qst=void 0,this.dxt="",this.Cxt="",this.ItemType=3;e=ConfigManager_1.ConfigManager.RoleConfig;let i=e.GetRoleConfig(t);t=i.ParentId,e=(i=0<t?e.GetRoleConfig(t):i).ElementId;this.mxt=i.Name,this.Qst=ConfigManager_1.ConfigManager.ElementInfoConfig.GetElementInfo(e),this.dxt=i.RoleHeadIconBig,this.Cxt=i.Introduction}GetRoleName(){return this.mxt}GetElementConfig(){return this.Qst}GetHeadTexutePath(){return this.dxt}GetRoleIntroduction(){return this.Cxt}}exports.TipsCharacterData=TipsCharacterData;class TipsOverPowerData extends ItemTipsData{constructor(t,e){super(t,e),this.ItemType=4}ConvertToPayShopGoods(){var t=new PayShopGoodsData_1.PayShopGoodsData,e=(t.PhraseFromTempData(this.ConfigId,0),new PayShopGoods_1.PayShopGoods(-1));return e.SetGoodsData(t),e}}exports.TipsOverPowerData=TipsOverPowerData;class TipsCardData extends ItemTipsData{constructor(t,e){super(t,e),this.ItemType=5}}exports.TipsCardData=TipsCardData;
//# sourceMappingURL=ItemTipsDefine.js.map