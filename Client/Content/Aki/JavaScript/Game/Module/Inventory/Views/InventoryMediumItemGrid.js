
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.InventoryMediumItemGrid=void 0;const MultiTextLang_1=require("../../../../Core/Define/ConfigQuery/MultiTextLang"),StringUtils_1=require("../../../../Core/Utils/StringUtils"),ControllerHolder_1=require("../../../Manager/ControllerHolder"),ModelManager_1=require("../../../Manager/ModelManager"),LoopScrollMediumItemGrid_1=require("../../Common/MediumItemGrid/LoopScrollMediumItemGrid"),RED_TICK_HEX="bf5c5c",TICK_COLOR_HEX="663738",RED_TICK_ALPHA=.9;class InventoryMediumItemGrid extends LoopScrollMediumItemGrid_1.LoopScrollMediumItemGrid{constructor(){super(...arguments),this.rdi=void 0,this.ndi=void 0,this.xth=void 0}get ItemSettleDone(){return!this.IsAnyComponentLoading}OnRefresh(e,t,i){var o=(this.rdi=e).GetItemViewInfo(),r=o.ItemDataType,s=o.QualityId,l=1===e.GetItemOperationType(),n={Type:4,Data:e,ItemConfigId:e.GetConfigId(),StarLevel:s,IsNewVisible:o.IsNewItem,IsLockVisible:o.IsLock,IsDeprecate:o.IsDeprecate,CoolDown:this.GetRemainingCoolDownTime(),TotalCoolDown:this.GetTotalCoolDownTime(),IsRedDotVisible:o.HasRedDot,IsDisable:l&&!e.IsItemCanDestroy(),IsCheckTick:o.IsSelectOn};switch(r){case 0:var a=this.rdi.GetItemDataBase();o.SelectOnNum?(d=MultiTextLang_1.configMultiTextLang.GetLocalTextNew("Text_ItemRecycleChosen_text"),d=StringUtils_1.StringUtils.Format(d,o.SelectOnNum.toString(),e.GetCount().toString()),n.BottomText=d):n.BottomText=e.GetCount().toString(),n.IsTimeFlagVisible=a.IsLimitTimeItem(),n.BuffIconType=a.GetConfig().ItemBuffType,n.IsOmitBottomText=!1;break;case 2:var d=this.rdi.GetItemDataBase().GetUniqueId(),a=ModelManager_1.ModelManager.WeaponModel.GetWeaponDataByIncId(d);n.BottomTextId="Text_LevelShow_Text",n.BottomTextParameter=[a.GetLevel()],n.Level=a.GetResonanceLevel(),n.RoleHeadInfo={RoleConfigId:a.GetRoleId()};break;case 3:var h,d=this.rdi.GetItemDataBase().GetUniqueId(),a=ModelManager_1.ModelManager.PhantomBattleModel.GetPhantomBattleData(d),_=a.GetCurrentSlotData();if(n.Level=a.GetCost(),n.IsLevelTextUseChangeColor=!0,n.BottomText="+"+a.GetPhantomLevel().toString(),n.IsOmitBottomText=!0,0<_.length){var C=_[0]?.SlotState??0,c=_[1]?.SlotState??0,I=_[2]?.SlotState??0;switch(s){case 3:n.VisionSlotStateList=[C];break;case 4:n.VisionSlotStateList=[C,c];break;case 5:n.VisionSlotStateList=[C,c,I]}}ControllerHolder_1.ControllerHolder.PhantomBattleController.CheckIsEquip(d)&&(_=a.GetUniqueId(),d=ControllerHolder_1.ControllerHolder.PhantomBattleController.GetEquipRole(_),h=ModelManager_1.ModelManager.PhantomBattleModel.CheckPhantomIsMain(_),n.VisionRoleHeadInfo={RoleConfigId:d,VisionUniqueId:_},n.IsMainVisionVisible=h),n.VisionFetterGroupId=a.GetFetterGroupId();break;default:n.BottomText=e.GetCount().toString()}this.Apply(n),this.SetCheckTickPerformance(o.IsSelectOn,RED_TICK_HEX,RED_TICK_ALPHA,TICK_COLOR_HEX),this.SetSelected(t)}OnAllComponentSettleDone(){this.xth?.(this.GridIndex)}OnSelected(e){this.SetSelected(!0)}OnDeselected(e){this.SetSelected(!1)}GetRemainingCoolDownTime(){var e=this.rdi.GetConfigId();return ModelManager_1.ModelManager.BuffItemModel.GetBuffItemRemainCdTime(e)}GetTotalCoolDownTime(){var e=this.rdi.GetConfigId();return ModelManager_1.ModelManager.BuffItemModel.GetBuffItemTotalCdTime(e)}RefreshCoolDown(){var e=this.GetRemainingCoolDownTime(),t=this.GetTotalCoolDownTime();this.SetCoolDown(e,t)}BindOnItemButtonClickedCallback(e){this.ndi=e}BindOnItemSettleDone(e){this.xth=e}OnExtendToggleStateChanged(e){this.ndi&&this.ndi(this.rdi)}}exports.InventoryMediumItemGrid=InventoryMediumItemGrid;
//# sourceMappingURL=InventoryMediumItemGrid.js.map