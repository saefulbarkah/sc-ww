
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ShipTowerLoadingView=void 0;const UE=require("ue"),AudioSystem_1=require("../../../../Core/Audio/AudioSystem"),Log_1=require("../../../../Core/Common/Log"),MathCommon_1=require("../../../../Core/Utils/Math/MathCommon"),EventDefine_1=require("../../../Common/Event/EventDefine"),EventSystem_1=require("../../../Common/Event/EventSystem"),ModelManager_1=require("../../../Manager/ModelManager"),UiTickViewBase_1=require("../../../Ui/Base/UiTickViewBase"),LoadingDefine_1=require("../../Loading/LoadingDefine");class ShipTowerLoadingView extends UiTickViewBase_1.UiTickViewBase{constructor(){super(...arguments),this.wvi=!1,this.qV_=void 0}OnRegisterComponent(){this.ComponentRegisterInfos=[[0,UE.UIText]]}OnStartImplementImplement(){this.qV_=ModelManager_1.ModelManager.LoadingModel,this.qV_?.SetIsLoadingView(!0),AudioSystem_1.AudioSystem.PostEvent(LoadingDefine_1.MUSIC_EVENT),Log_1.Log.CheckInfo()&&Log_1.Log.Info("Audio",69,"[Game.Loading] ShipTowerLoading 音乐播放")}OnAfterShow(){EventSystem_1.EventSystem.Emit(EventDefine_1.EEventName.LoadingViewOnAfterShow)}OnBeforeShow(){this.cEo()}OnBeforeDestroyImplement(){AudioSystem_1.AudioSystem.ExecuteAction(LoadingDefine_1.MUSIC_EVENT,0),Log_1.Log.CheckInfo()&&Log_1.Log.Info("Audio",69,"[Game.Loading] Loading 音乐停止");var e=this.qV_;if(e)for(e.SetIsLoadingView(!1),EventSystem_1.EventSystem.Emit(EventDefine_1.EEventName.RefreshCursor);e.ReachHandleQueue.Size;)e.ReachHandleQueue.Pop()[1](),Log_1.Log.CheckInfo()&&Log_1.Log.Info("Loading",69,"OnBeforeDestroyImplement",["loadingModel.ReachHandleQueue.Size",e.ReachHandleQueue.Size])}OnTick(e){var i=this.qV_;if(i){var o=i.CurrentProgress+i.Speed*i.SpeedRate*e,o=Math.min(o,i.NextProgress);for(i.CurrentProgress=o,this.cEo();i.ReachHandleQueue.Size;){var t=i.ReachHandleQueue.Front;if(t[0]>o)break;i.ReachHandleQueue.Pop(),t[1](),Log_1.Log.CheckInfo()&&Log_1.Log.Info("Loading",69,"TickProgress",["progress",o])}!this.wvi&&o>=MathCommon_1.MathCommon.ProgressTotalValue&&(this.wvi=!0,this.CloseMe())}}cEo(){var e=Math.round(this.qV_?.CurrentProgress??0);this.GetText(0)?.SetText(e+"%")}}exports.ShipTowerLoadingView=ShipTowerLoadingView;
//# sourceMappingURL=ShipTowerLoadingView.js.map