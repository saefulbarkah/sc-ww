
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ShipTowerController=void 0;const Log_1=require("../../../Core/Common/Log"),Protocol_1=require("../../../Core/Define/Net/Protocol"),Net_1=require("../../../Core/Net/Net"),EventDefine_1=require("../../Common/Event/EventDefine"),EventSystem_1=require("../../Common/Event/EventSystem"),ConfigManager_1=require("../../Manager/ConfigManager"),ControllerHolder_1=require("../../Manager/ControllerHolder"),ModelManager_1=require("../../Manager/ModelManager"),UiControllerBase_1=require("../../Ui/Base/UiControllerBase"),UiManager_1=require("../../Ui/UiManager");class ShipTowerController extends UiControllerBase_1.UiControllerBase{static OnRegisterNetEvent(){Net_1.Net.Register(26641,e=>{Log_1.Log.CheckDebug()&&Log_1.Log.Debug("ShipTower",69,"vy_",["割草爬塔活动副本积分结算推送",e]),ModelManager_1.ModelManager.ShipTowerModel.UpdateResultNotify(e)}),Net_1.Net.Register(20814,e=>{Log_1.Log.CheckDebug()&&Log_1.Log.Debug("ShipTower",69,"yy_",["割草爬塔关卡信息更新",e]),ModelManager_1.ModelManager.ShipTowerModel.UpdateLevelPlayNotify(e)})}static OnUnRegisterNetEvent(){Net_1.Net.UnRegister(26641),Net_1.Net.UnRegister(20814)}static OnAddEvents(){EventSystem_1.EventSystem.Add(EventDefine_1.EEventName.WorldDoneAndCloseLoading,this.Yn_),EventSystem_1.EventSystem.Add(EventDefine_1.EEventName.OnAddCommonItemList,this.LG_),EventSystem_1.EventSystem.Add(EventDefine_1.EEventName.OnFunctionOpenUpdate,this.a8_)}static OnRemoveEvents(){EventSystem_1.EventSystem.Remove(EventDefine_1.EEventName.WorldDoneAndCloseLoading,this.Yn_),EventSystem_1.EventSystem.Remove(EventDefine_1.EEventName.OnAddCommonItemList,this.LG_),EventSystem_1.EventSystem.Remove(EventDefine_1.EEventName.OnFunctionOpenUpdate,this.a8_)}static RequestChallenge(e,o=!1,r=!1){var t=e.TeamDataList[0],a=e.TeamDataList[1],n=new Protocol_1.Aki.Protocol.$n_,e=(n.ELl=e.Id,n.TLl=e.GetAllTeamBuffIdList(),n.LLl=a.GetRoleIdListEdit(),n.T9_=r,ModelManager_1.ModelManager.InstanceDungeonModel.InstanceEnterContentText.$n_=n,(o?a:t).GetRoleIdListEdit()),r=(o?a:t).InstId;ControllerHolder_1.ControllerHolder.InstanceDungeonController.PrewarTeamFightRequest(r,e,0,0)}static async SlashAndTowerInfoRequest(){var e=Protocol_1.Aki.Protocol.dy_.create(),e=(Log_1.Log.CheckDebug()&&Log_1.Log.Debug("ShipTower",69,"dy_"),await Net_1.Net.CallAsync(19991,e));Log_1.Log.CheckDebug()&&Log_1.Log.Debug("ShipTower",69,"my_",["",e]),ModelManager_1.ModelManager.ShipTowerModel.SlashAndTowerInfoResponse(e)}static async SlashAndTowerScoreRewardRequest(e){var o=new Protocol_1.Aki.Protocol.fy_,e=(o.s5n=e,Log_1.Log.CheckDebug()&&Log_1.Log.Debug("ShipTower",69,"fy_",["",o]),await Net_1.Net.CallAsync(29579,o));Log_1.Log.CheckDebug()&&Log_1.Log.Debug("ShipTower",69,"Cy_",["",e]),ModelManager_1.ModelManager.ShipTowerModel.SlashAndTowerScoreRewardResponse(e)}static async EndLessHistoryRequest(){var e=Protocol_1.Aki.Protocol.gy_.create(),e=(Log_1.Log.CheckDebug()&&Log_1.Log.Debug("ShipTower",69,"gy_"),await Net_1.Net.CallAsync(17579,e));Log_1.Log.CheckDebug()&&Log_1.Log.Debug("ShipTower",69,"py_",["",e]),ModelManager_1.ModelManager.ShipTowerModel.EndLessHistoryResponse(e)}static async SlashAndTowerSaveRecordRequest(e){var o=new Protocol_1.Aki.Protocol.Sy_,o=(o.s5n=e,Log_1.Log.CheckDebug()&&Log_1.Log.Debug("ShipTower",69,"Sy_",["",o]),await Net_1.Net.CallAsync(25369,o));Log_1.Log.CheckDebug()&&Log_1.Log.Debug("ShipTower",69,"My_",["",o]),ModelManager_1.ModelManager.ShipTowerModel.SlashAndTowerSaveRecordResponse(e,o)}static async SlashAndTowerResetRequest(e){var o=new Protocol_1.Aki.Protocol.Ey_,o=(o.s5n=e,Log_1.Log.CheckDebug()&&Log_1.Log.Debug("ShipTower",69,"Ey_",["",o]),await Net_1.Net.CallAsync(24247,o));Log_1.Log.CheckDebug()&&Log_1.Log.Debug("ShipTower",69,"Iy_",["",o]),ModelManager_1.ModelManager.ShipTowerModel.SlashAndTowerResetResponse(e,o)}static async SlashAndTowerRecommendRequest(e){var o=new Protocol_1.Aki.Protocol.Ty_,o=(o.s5n=e,Log_1.Log.CheckDebug()&&Log_1.Log.Debug("ShipTower",69,"Ty_",["",o]),await Net_1.Net.CallAsync(17051,o));Log_1.Log.CheckDebug()&&Log_1.Log.Debug("ShipTower",69,"by_",["",o]),ModelManager_1.ModelManager.ShipTowerModel.SlashAndTowerRecommendResponse(e,o)}static async SlashAndTowerReviewRequest(){var e=Protocol_1.Aki.Protocol.iG_.create(),e=(Log_1.Log.CheckDebug()&&Log_1.Log.Debug("ShipTower",69,"iG_"),await Net_1.Net.CallAsync(16220,e));Log_1.Log.CheckDebug()&&Log_1.Log.Debug("ShipTower",69,"rG_",["",e]),ModelManager_1.ModelManager.ShipTowerModel.SlashAndTowerReviewResponse(e)}}(exports.ShipTowerController=ShipTowerController).Yn_=()=>{ModelManager_1.ModelManager.ShipTowerModel.InitData(),ModelManager_1.ModelManager.ShipTowerModel.CheckInitProto()},ShipTowerController.LG_=e=>{e.forEach(e=>{var e=ConfigManager_1.ConfigManager.ItemConfig.GetConfig(e.s5n);60005===e?.ItemType&&(e=ConfigManager_1.ConfigManager.ShipTowerConfig.GetBuffCfgByItemIdList(e.Id)?.filter(e=>!ModelManager_1.ModelManager.ShipTowerModel.IsOldSeason(e.Season))[0])&&ModelManager_1.ModelManager.ShipTowerModel.AddShowBuffId(e.Id,1===e.Tips)}),UiManager_1.UiManager.IsViewOpen("ShipTowerView")&&ModelManager_1.ModelManager.ShipTowerModel.CheckShowGetBuff()},ShipTowerController.a8_=(e,o)=>{o&&10081===e&&ModelManager_1.ModelManager.ShipTowerModel.CheckInitProto()};
//# sourceMappingURL=ShipTowerController.js.map