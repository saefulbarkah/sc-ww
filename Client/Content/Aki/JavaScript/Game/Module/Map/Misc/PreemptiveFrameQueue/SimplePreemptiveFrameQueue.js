
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.SimplePreemptiveFrameQueue=void 0;class SimplePreemptiveFrameQueue{constructor(s){this.PerFrameTaskLimit=s,this.Tasks=[],this.Ieh=void 0,this.Teh=0,this.EnableFlush=!1}AddTask(s){let t=0;for(;t<this.Tasks.length&&this.Tasks[t].Priority<s.Priority;)t++;this.Tasks.splice(t,0,s)}CancelTask(t){var s=this.Tasks.findIndex(s=>s===t);-1<s&&(t.Cancel?.(),this.Tasks.splice(s,1))}TryExecuteNextTask(){if(this.IsTaskComplete()){for(this.Teh=0;0<this.Tasks.length&&this.Teh<this.PerFrameTaskLimit;)if(this.Ieh=this.ShiftNextTask(),this.Ieh){if(this.Ieh.Execute(),this.EnableFlush||this.Teh++,!this.IsTaskComplete())break;this.OnTaskComplete(this.Ieh)}this.Tasks.length||(this.Ieh=void 0)}else this.Ieh.FrameExecute?.()}ShiftNextTask(){if(0<this.Tasks.length)return this.Tasks.shift()}OnTaskComplete(s){}IsTaskComplete(){return!this.Ieh||(this.Ieh.IsComplete?.()??!0)}Dispose(){this.Ieh?.Cancel?.(),this.Ieh=void 0,this.Tasks.length=0}}exports.SimplePreemptiveFrameQueue=SimplePreemptiveFrameQueue;
//# sourceMappingURL=SimplePreemptiveFrameQueue.js.map