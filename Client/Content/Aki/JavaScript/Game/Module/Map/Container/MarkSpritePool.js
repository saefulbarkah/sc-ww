
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.MarkSpritePool=void 0;const Time_1=require("../../../../Core/Common/Time"),MAX_SPRITE_HANDLE_CACHE_TIME=1e4;class MarkSpritePool{static Get(t,i){var s=this.kH_.get(i);if(void 0!==s)return this.Ref(t,i,s.Obj),s.Obj}static Ref(t,i,s){let e=this.qH_.get(t),o=(void 0===e&&(e=new Set,this.qH_.set(t,e)),e.add(i),this.kH_.get(i));void 0!==o?++o.Ref:(o={SpritePath:i,RecycleTimeStamp:0,Obj:s,Ref:1},this.kH_.set(i,o))}static UnRef(t){var i=this.qH_.get(t);if(void 0!==i){for(const e of i){var s=this.kH_.get(e);void 0!==s&&(--s.Ref,s.Ref<=0)&&(s.RecycleTimeStamp=Time_1.Time.ServerTimeStamp,this.kH_.delete(e))}this.qH_.delete(t)}}static Tick(){this.OH_.length=0;for(const i of this.kH_.values()){var t=Time_1.Time.ServerTimeStamp-i.RecycleTimeStamp;(i.Ref<=0&&t>MAX_SPRITE_HANDLE_CACHE_TIME||!i.Obj?.IsValid())&&this.OH_.push(i.SpritePath)}for(const s of this.OH_)this.kH_.delete(s)}static Dispose(){this.qH_.clear(),this.kH_.clear()}}(exports.MarkSpritePool=MarkSpritePool).qH_=new Map,MarkSpritePool.kH_=new Map,MarkSpritePool.OH_=[];
//# sourceMappingURL=MarkSpritePool.js.map