
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.MarkSpritePool=void 0;const Time_1=require("../../../../Core/Common/Time"),MAX_SPRITE_HANDLE_CACHE_TIME=1e4;class MarkSpritePool{static Get(t,i){var s=this.fW_.get(i);if(void 0!==s)return this.Ref(t,i,s.Obj),s.Obj}static Ref(t,i,s){let e=this.gW_.get(t),o=(void 0===e&&(e=new Set,this.gW_.set(t,e)),e.add(i),this.fW_.get(i));void 0!==o?++o.Ref:(o={SpritePath:i,RecycleTimeStamp:0,Obj:s,Ref:1},this.fW_.set(i,o))}static UnRef(t){var i=this.gW_.get(t);if(void 0!==i){for(const e of i){var s=this.fW_.get(e);void 0!==s&&(--s.Ref,s.Ref<=0)&&(s.RecycleTimeStamp=Time_1.Time.ServerTimeStamp,this.fW_.delete(e))}this.gW_.delete(t)}}static Tick(){this.CW_.length=0;for(const i of this.fW_.values()){var t=Time_1.Time.ServerTimeStamp-i.RecycleTimeStamp;(i.Ref<=0&&t>MAX_SPRITE_HANDLE_CACHE_TIME||!i.Obj?.IsValid())&&this.CW_.push(i.SpritePath)}for(const s of this.CW_)this.fW_.delete(s)}static Dispose(){this.gW_.clear(),this.fW_.clear()}}(exports.MarkSpritePool=MarkSpritePool).gW_=new Map,MarkSpritePool.fW_=new Map,MarkSpritePool.CW_=[];
//# sourceMappingURL=MarkSpritePool.js.map