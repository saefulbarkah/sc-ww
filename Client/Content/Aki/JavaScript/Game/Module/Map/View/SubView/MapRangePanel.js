
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.MapRangePanel=void 0;const EventDefine_1=require("../../../../Common/Event/EventDefine"),EventSystem_1=require("../../../../Common/Event/EventSystem"),ConfigManager_1=require("../../../../Manager/ConfigManager"),ModelManager_1=require("../../../../Manager/ModelManager"),MarkRangeImageComponent_1=require("../../Marks/MarkItemView/Components/MarkRangeImageComponent");class MapRangePanel{constructor(e){this.Map=e,this.jnn=void 0,this.TRi=void 0,this.h2l=()=>{this.SetRangeComponentHide()},EventSystem_1.EventSystem.Add(EventDefine_1.EEventName.HideNavigateMarkRange,this.h2l)}async wNl(){this.jnn||(this.jnn=new MarkRangeImageComponent_1.MarkRangeImageComponent,this.TRi=this.jnn.CreateThenShowByResourceIdAsync("UiItem_MarkArea_Prefab",this.Map.GetRootItem(),!0)),await this.TRi}async SetRangeComponentShow(e,t,a){await this.wNl();var n=t&&a?0:ConfigManager_1.ConfigManager.CommonConfig.GetPlayPointTrackRange();this.jnn?.SetUiActive(!0),this.jnn?.GetRootItem().SetAnchorOffset(e.ToUeVector2D(!0)),this.jnn?.RangeArea.SetWidth(t??n),this.jnn?.RangeArea.SetHeight(a??n),ModelManager_1.ModelManager.WorldMapModel.MapRangeInfo={Position:e,Width:t,Height:a,MapId:this.Map.MapId}}async SetRangeComponentHide(){await this.BNl(),this.jnn?.SetUiActive(!1),ModelManager_1.ModelManager.WorldMapModel.MapRangeInfo=void 0}async BNl(){await this.TRi}CheckExploreMarkRangeInfo(){var e=ModelManager_1.ModelManager.WorldMapModel.MapRangeInfo;e&&e.MapId===this.Map.MapId&&(this.Fx_()?this.SetRangeComponentHide():this.SetRangeComponentShow(e.Position,e.Width,e.Height))}Fx_(){var e,t=ModelManager_1.ModelManager.WorldMapModel.NavigateMarkShowRangeInfo;return!!t&&(!!t.IsDiscover||((e=this.Map.GetMarkItem(t.MarkType,t.MarkId))?(e.MarkItemEntity.IsTempHide=e.MarkItemEntity.IsTempMapMark,e.GamePlayIsDiscover()??!1):!!(e=ConfigManager_1.ConfigManager.MapConfig.GetConfigMark(t.MarkId))&&(t=e.RelativeDungeonId,e=e.RelativeId,ModelManager_1.ModelManager.LevelPlayReportModel.IsCommonLevelPlayDiscover(t,e))))}Destroy(){this.jnn&&(this.jnn.SkipDestroyActor=!1,this.jnn.Destroy(),this.jnn=void 0),EventSystem_1.EventSystem.Remove(EventDefine_1.EEventName.HideNavigateMarkRange,this.h2l)}}exports.MapRangePanel=MapRangePanel;
//# sourceMappingURL=MapRangePanel.js.map