
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.MapMarkPreemptiveFrameQueue=void 0;const EventDefine_1=require("../../../../../../Common/Event/EventDefine"),EventSystem_1=require("../../../../../../Common/Event/EventSystem"),SimplePreemptiveFrameQueue_1=require("../../../../Misc/PreemptiveFrameQueue/SimplePreemptiveFrameQueue");class MapMarkPreemptiveFrameQueue extends SimplePreemptiveFrameQueue_1.SimplePreemptiveFrameQueue{constructor(){super(...arguments),this.Leh=new Map}AddTask(e){super.AddTask(e);let t=this.Leh.get(e.MarkType);t||(t=new Map,this.Leh.set(e.MarkType,t)),t.set(e.MarkId,e)}ForceExecuteTask(e,t){var s=this.Deh(e,t);s&&(s.Execute(),this.CancelMapTask(e,t))}Flush(){this.EnableFlush=!0,this.TryExecuteNextTask(),this.EnableFlush=!1}CancelMapTask(e,t){e=this.Deh(e,t);e&&(this.CancelTask(e),this.Aeh(e))}Aeh(e){var t=this.Leh.get(e.MarkType);t&&t.delete(e.MarkId)}Deh(e,t){if(0===e){let e=void 0;for(const[,s]of this.Leh)if(e=s.get(t))break;return e}const s=this.Leh.get(e);if(s)return s.get(t)}CancelMapTaskByType(e){e=this.Leh.get(e);if(e)for(var[,t]of e)this.CancelTask(t),this.Aeh(t)}OnTaskComplete(e){super.OnTaskComplete(e);this.Aeh(e),EventSystem_1.EventSystem.Emit(EventDefine_1.EEventName.OnMapMarkTaskComplete,e.MarkType,e.MarkId)}}exports.MapMarkPreemptiveFrameQueue=MapMarkPreemptiveFrameQueue;
//# sourceMappingURL=MapMarkPreemptiveFrameQueue.js.map