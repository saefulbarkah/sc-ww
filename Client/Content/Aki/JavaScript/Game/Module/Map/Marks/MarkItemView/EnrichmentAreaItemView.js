
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.EnrichmentAreaItemView=void 0;const UE=require("ue"),EventDefine_1=require("../../../../Common/Event/EventDefine"),EventSystem_1=require("../../../../Common/Event/EventSystem"),ConfigManager_1=require("../../../../Manager/ConfigManager"),WorldMapDefine_1=require("../../../WorldMap/WorldMapDefine"),MarkBlueRangeImageComponent_1=require("./Components/MarkBlueRangeImageComponent"),ServerMarkItemView_1=require("./ServerMarkItemView");class EnrichmentAreaItemView extends ServerMarkItemView_1.ServerMarkItemView{constructor(e){super(e),this.fNa=void 0,this.kRi=void 0,this.Zbn=e=>{var t=this.Holder;this.IsSelectThisFloor=t.GetMultiMapId()===e,this.OnIconPathChanged(t.IconPath)}}OnInitialize(){super.OnInitialize(),EventSystem_1.EventSystem.Add(EventDefine_1.EEventName.WorldMapSelectMultiMap,this.Zbn),this.kRi=new UE.Vector2D(this.Holder.UiPosition.X,this.Holder.UiPosition.Y),this.vNa(!0),this.OnIconPathChanged(this.Holder.IconPath)}OnBeforeDestroy(){EventSystem_1.EventSystem.Remove(EventDefine_1.EEventName.WorldMapSelectMultiMap,this.Zbn),this.RangeComponentInternal&&(this.RangeComponentInternal.Destroy(),EventSystem_1.EventSystem.Emit(EventDefine_1.EEventName.TakeMarkComponentExitContainer,this.Holder.MarkType,0)),super.OnBeforeDestroy()}OnAfterShow(){super.OnAfterShow(),this.UpdateMultiMapFloorSelectedState(),this.OnIconPathChanged(this.Holder.IconPath)}async GetRangeComponentAsync(){var e;return this.RangeComponentInternal||(this.RangeComponentInternal=new MarkBlueRangeImageComponent_1.MarkBlueRangeImageComponent,await this.RangeComponentInternal.CreateThenShowByResourceIdAsync("UiItem_ProbeArea",this.RootItem.GetParentAsUIItem(),!0),this.RangeComponentInternal?.GetRootItem()?.SetAnchorOffset(this.kRi),this.RangeComponentInternal?.GetRootItem()&&EventSystem_1.EventSystem.Emit(EventDefine_1.EEventName.TakeMarkComponentEnterContainer,this.RangeComponentInternal?.GetRootItem(),this.Holder.MarkType,0),this.SetScale(this.Holder.MarkScale),e=this.Holder.MarkRange,this.RangeComponentInternal.RangeImage.SetWidth(2*e),this.RangeComponentInternal.RangeImage.SetHeight(2*e)),this.RangeComponentInternal}vNa(e){this.fNa!==e&&(this.fNa=e,this.GetRangeComponentAsync().then(e=>{e.SetActive(this.fNa),this.RangeComponentInternal?.GetRootItem()?.SetAnchorOffset(this.kRi)}))}OnSafeUpdate(e,t,i){var s,n,r;this.Holder&&(s=this.GetSprite(1),n=(r=this.Holder).CheckCanShowIcon(),r=r.CheckCanShowView(),s?.SetUIActive(n),this.RangeComponentInternal?.SetUiActive(r))}OnIconPathChanged(e){const t=this.Holder.CheckCanShowIcon();var i=this.GetSprite(1);t?this.LoadIcon(i,e):i.SetUIActive(t),this.Holder.IsMultiMap()&&this.GetChildIconComponentAsync().then(e=>{e.SetUiActive(t),e.Icon=this.IsSelectThisFloor?ConfigManager_1.ConfigManager.UiResourceConfig.GetResourcePath(WorldMapDefine_1.MULTI_MAP_SELECT_ICON_PATH):ConfigManager_1.ConfigManager.UiResourceConfig.GetResourcePath(WorldMapDefine_1.MULTI_MAP_ICON_PATH)})}UpdateMultiMapFloorSelectedState(){var e=this.Holder,t=this.IsSelectThisFloor;this.IsSelectThisFloor=e.GetIsSelectThisFloor(),t!==this.IsSelectThisFloor&&this.OnIconPathChanged(e.IconPath)}ShowVerticalPointer(){return!1}}exports.EnrichmentAreaItemView=EnrichmentAreaItemView;
//# sourceMappingURL=EnrichmentAreaItemView.js.map