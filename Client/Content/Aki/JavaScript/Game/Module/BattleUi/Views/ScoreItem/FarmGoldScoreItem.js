
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.FarmGoldScoreItem=void 0;const UE=require("ue"),EventDefine_1=require("../../../../Common/Event/EventDefine"),EventSystem_1=require("../../../../Common/Event/EventSystem"),ModelManager_1=require("../../../../Manager/ModelManager"),BaseScoreItem_1=require("./BaseScoreItem");class FarmGoldScoreItem extends BaseScoreItem_1.BaseScoreItem{constructor(){super(...arguments),this.i7l=!1,this.r7l=0,this.o7l=[],this.n7l=[],this.oTn=(e,t)=>{var s=this.n7l.slice(),r=t.toString(),i=r.length;0===i&&(this.n7l.length=0);for(let e=this.n7l.length=0;e<i;e++)this.n7l.push(parseInt(r[e]));var h=this.s7l(this.o7l);if(this.o7l.length=0,t<h)this.o7l=this.n7l.slice(),this.i7l=!1;else{this.o7l=s.slice();for(let e=0;e<i-s.length;e++)this.o7l.unshift(0);this.r7l=0<=i-2?i-2:0,this.i7l=!this.a7l(this.r7l,this.o7l,this.n7l)}this.h7l(this.o7l)}}OnRegisterComponent(){this.ComponentRegisterInfos=[[0,UE.UIArtText]]}OnStart(){EventSystem_1.EventSystem.Add(EventDefine_1.EEventName.BattleScoreChanged,this.oTn),this.h7l(this.o7l);for(var[e,t]of ModelManager_1.ModelManager.BattleScoreModel.GetScoreMap())0<t&&this.IsValidScore(e)&&this.oTn(e,t)}IsValidScore(e){e=ModelManager_1.ModelManager.BattleScoreModel?.GetScoreConfig(e);return!(!e||0!==e.Type)}OnBeforeDestroy(){EventSystem_1.EventSystem.Remove(EventDefine_1.EEventName.BattleScoreChanged,this.oTn)}OnTick(e){this.i7l&&(this.l7l(this.r7l,this.o7l),this._7l(this.r7l,this.o7l),this.i7l=!this.a7l(this.r7l,this.o7l,this.n7l),this.i7l||(this.o7l=this.n7l.slice()),this.h7l(this.o7l))}h7l(e){let t="";for(const s of e)t+=s.toString();t=""===t?"0":t,this.GetArtText(0)?.SetText(t.toString())}l7l(t,s){var r=s.length;for(let e=t+1;e<r;e++)s[e]+=1,9<s[e]&&(s[e]=0)}_7l(e,t){let s=e;for(;0<=s&&(t[s]+=1,9<t[s]);)t[s]=0,s--}a7l(t,s,r){for(let e=0;e<=t;e++)if(s[e]!==r[e])return!1;return!0}s7l(t){var s=t.length;let r=0;for(let e=0;e<s;e++)r+=t[e]*Math.pow(10,s-e-1);return r}}exports.FarmGoldScoreItem=FarmGoldScoreItem;
//# sourceMappingURL=FarmGoldScoreItem.js.map