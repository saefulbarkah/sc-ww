
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.SpecialEnergyBarLuoKeKe=void 0;const UE=require("ue"),Log_1=require("../../../../../../Core/Common/Log"),Time_1=require("../../../../../../Core/Common/Time"),SpecialEnergyBarBase_1=require("../SpecialEnergyBarBase"),SpecialEnergyBarSlot_1=require("../SpecialEnergyBarSlot"),NUM=3,EFFECT_TIME=1e3,ghostTags=[1459704896,-1325526953,-1895287750];class SpecialEnergyBarLuoKeKe extends SpecialEnergyBarBase_1.SpecialEnergyBarBase{constructor(){super(...arguments),this.Rdt=void 0,this.u8l=[],this.d8l=[],this.Fdt=!1,this.m8l=0,this.pVl=!1,this.vVl=0,this.yVl=0,this.SVl=(t,s)=>{s?(this.pVl=!0,Log_1.Log.CheckDebug()&&Log_1.Log.Debug("Battle",17,"【能量条】洛可可鬼头状态更新",["",this.pVl])):this.MVl(),this.EVl()}}OnRegisterComponent(){this.ComponentRegisterInfos=[[0,UE.UIItem],[1,UE.UIItem],[2,UE.UIItem],[3,UE.UIItem],[4,UE.UIItem],[5,UE.UIItem],[6,UE.UIItem],[7,UE.UIItem],[8,UE.UIItem]]}async OnBeforeStartAsync(){var t=[];t.push(this.InitBarItem()),await Promise.all(t)}async InitBarItem(){this.Rdt=new SpecialEnergyBarSlot_1.SpecialEnergyBarSlot,this.Rdt.InitData(this.RoleData,this.Config,!0),await this.Rdt.InitByActorAsync(this.GetItem(0).GetOwner())}MVl(){this.pVl=!1;for(const t of ghostTags)if(this.TagComponent?.HasTag(t)){this.pVl=!0;break}Log_1.Log.CheckDebug()&&Log_1.Log.Debug("Battle",17,"【能量条】洛可可鬼头状态更新",["",this.pVl])}AddEvents(){super.AddEvents();for(const t of ghostTags)this.ListenForTagAddOrRemoveChanged(t,this.SVl)}OnStart(){this.InitTweenAnim(7),this.InitTweenAnim(8),this.MVl();for(let t=0;t<NUM;t++)this.u8l.push(this.GetItem(1+t)),this.d8l.push(this.GetItem(4+t)),this.d8l[t].SetUIActive(!1);this.EVl(!0)}OnBarPercentChanged(){this.EVl()}EVl(s=!1){var t=this.PercentMachine.GetCurPercent(),i=Math.floor(3*t),e=this.pVl?i:0;if(this.yVl!==e){if(Log_1.Log.CheckDebug()&&Log_1.Log.Debug("Battle",17,"【能量条】洛可可鬼头数量更新",["new",e],["old",this.yVl],["inGhost",this.pVl]),e>this.yVl){for(let t=0;t<NUM;t++){var h=t<e;this.u8l[t].SetUIActive(h),s&&h&&this.u8l[t].SetAlpha(1)}s||(this.StopTweenAnim(8),this.PlayTweenAnim(7))}else s||(this.StopTweenAnim(7),this.PlayTweenAnim(8));if(this.pVl)for(let t=0;t<NUM;t++)this.Rdt.SetFullEffectVisible(t,!1);else for(let t=0;t<NUM;t++){var r=t<i;this.Rdt.SetFullEffectVisible(t,r)}this.yVl=e}if(this.vVl!==i){if(i<this.vVl){Log_1.Log.CheckDebug()&&Log_1.Log.Debug("Battle",17,"【能量条】洛可可鬼头使用",["new",i],["old",this.vVl],["inGhost",this.pVl]);for(let t=i;t<this.vVl;t++)this.d8l[t].SetUIActive(!0),this.m8l=Time_1.Time.Now+EFFECT_TIME,this.Fdt=!0}this.vVl=i}}Tick(t){if(super.Tick(t),this.Rdt?.Tick(t),this.Fdt&&this.m8l<=Time_1.Time.Now){for(const s of this.d8l)s.SetUIActive(!1);this.Fdt=!1}}}exports.SpecialEnergyBarLuoKeKe=SpecialEnergyBarLuoKeKe;
//# sourceMappingURL=SpecialEnergyBarLuoKeKe.js.map