
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.PlotChildView=void 0;const puerts_1=require("puerts"),UE=require("ue"),CustomPromise_1=require("../../../../Core/Common/CustomPromise"),Log_1=require("../../../../Core/Common/Log"),UiPanelBase_1=require("../../../Ui/Base/UiPanelBase"),LevelSequencePlayer_1=require("../../Common/LevelSequencePlayer");class PlotChildView extends UiPanelBase_1.UiPanelBase{constructor(){super(...arguments),this.LevelSequencePlayer=void 0}OnBeforeDestroy(){this.LevelSequencePlayer?.Clear()}async OpenAsync(e,i,s,o=!0){i?(await this.CreateThenShowByResourceIdAsync(i,e,!1),this.LevelSequencePlayer=new LevelSequencePlayer_1.LevelSequencePlayer(this.RootItem),this.LevelSequencePlayer?.PlayLevelSequenceByName("Start",!1),this.LevelSequencePlayer?.PlayLevelSequenceByName("Loop",!1),this.PlaySpineAnimation(s,o)):Log_1.Log.CheckError()&&Log_1.Log.Error("Plot",45,"Ui预览图:打开Ui预览图，但Ui预制体名称为空",["uiName",i])}async PlayUiLevelSequence(e){var i=new CustomPromise_1.CustomPromise;return this.LevelSequencePlayer?.StopCurrentSequence(!1,!0),this.LevelSequencePlayer?.PlaySequencePurely(e,!1,!1,i),i.Promise}async CloseAsync(){await this.LevelSequencePlayer?.PlaySequenceAsync("Close",new CustomPromise_1.CustomPromise),await this.HideAsync(),await this.DestroyAsync()}PlaySpineAnimation(i,s=!0){var e=(0,puerts_1.$ref)(void 0);if(""!==i){this.RootItem?.GetAllAttachUIChildren(e);var o=(0,puerts_1.$unref)(e);for(let e=0;e<o.Num();e++){var t=o.Get(e);t.IsA(UE.UISpineRenderable.StaticClass())&&(t=t.GetOwner()?.GetComponentByClass(UE.SpineSkeletonAnimationComponent.StaticClass()),Log_1.Log.CheckInfo()&&Log_1.Log.Info("Plot",45,"Ui预览图:播放Spine动画",["spineName",i],["isLoop",s]),t.SetAnimation(0,i,s))}}}}exports.PlotChildView=PlotChildView;
//# sourceMappingURL=PlotChildView.js.map