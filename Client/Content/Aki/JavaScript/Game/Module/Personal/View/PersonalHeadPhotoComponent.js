
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.PersonalHeadPhotoComponent=void 0;const UE=require("ue"),ModelManager_1=require("../../../Manager/ModelManager"),UiPanelBase_1=require("../../../Ui/Base/UiPanelBase"),UiManager_1=require("../../../Ui/UiManager"),LguiUtil_1=require("../../Util/LguiUtil"),GenericScrollViewNew_1=require("../../Util/ScrollView/GenericScrollViewNew"),PersonalController_1=require("../Controller/PersonalController"),PersonalRoleSmallItemGrid_1=require("./PersonalRoleSmallItemGrid");class PersonalHeadPhotoComponent extends UiPanelBase_1.UiPanelBase{constructor(){super(...arguments),this.xqe=void 0,this.PlayerHeadDataList=[],this.p5t=()=>{PersonalController_1.PersonalController.SendChangeHeadPhotoRequest(this.l3l.Id),UiManager_1.UiManager.CloseView("PersonalEditView"),UiManager_1.UiManager.CloseView("PersonalOptionView")},this.Y5i=()=>{var e=new PersonalRoleSmallItemGrid_1.PersonalRoleSmallItemGrid;return e.BindToggleClickCallBack(this.sVi),e},this.sVi=e=>{this.aVi(e)}}get l3l(){var e=this.xqe.GetGenericLayout().GetSelectedGridIndex();if(!(e<0||e>=this.PlayerHeadDataList.length))return this.PlayerHeadDataList[e]}OnRegisterComponent(){this.ComponentRegisterInfos=[[0,UE.UIScrollViewWithScrollbarComponent],[1,UE.UITexture],[2,UE.UIButtonComponent],[3,UE.UIText],[4,UE.UIInteractionGroup],[5,UE.UIText],[6,UE.UIText],[7,UE.UIText]],this.BtnBindInfo=[[2,this.p5t]]}async OnBeforeStartAsync(){if(this.PlayerHeadDataList=ModelManager_1.ModelManager.PersonalModel.GetPlayerShowHeadDataList(),this.xqe=new GenericScrollViewNew_1.GenericScrollViewNew(this.GetScrollViewWithScrollbar(0),this.Y5i),0<this.PlayerHeadDataList.length){await this.xqe.RefreshByDataAsync(this.PlayerHeadDataList);const t=ModelManager_1.ModelManager.PersonalModel.GetHeadPhotoId();var e=this.PlayerHeadDataList.findIndex(e=>e.Id===t);this.xqe.ScrollTo(this.xqe.GetItemByIndex(e)),this.aVi(this.PlayerHeadDataList[e])}let i=0;for(const r of this.PlayerHeadDataList)r.Lock||i++;LguiUtil_1.LguiUtil.SetLocalText(this.GetText(3),"Collected",i)}aVi(i){var e=this.PlayerHeadDataList.findIndex(e=>e===i),e=(this.xqe?.GetGenericLayout()?.SelectGridProxy(e),ModelManager_1.ModelManager.PersonalModel.GetHeadPhotoId()),e=(this.GetInteractionGroup(4).SetInteractable(!i.Lock&&e!==i.Id),e===i.Id?"Text_InUse_Text":"ConfirmBox_173_ButtonText_1");LguiUtil_1.LguiUtil.SetLocalTextNew(this.GetText(7),e);const t=this.GetTexture(1);t.SetUIActive(!1),this.SetTextureShowUntilLoaded(i.GetRoleHeadIconCircle(),t,()=>{t.SetUIActive(!0)}),this.GetText(5).ShowTextNew(i.GetName());e=this.GetText(6);e.SetUIActive(i.Lock),LguiUtil_1.LguiUtil.SetLocalTextNew(e,i.Config.Tips)}}exports.PersonalHeadPhotoComponent=PersonalHeadPhotoComponent;
//# sourceMappingURL=PersonalHeadPhotoComponent.js.map