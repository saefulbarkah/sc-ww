
"use strict";var _a;Object.defineProperty(exports,"__esModule",{value:!0}),exports.PersonalController=void 0;const Protocol_1=require("../../../../Core/Define/Net/Protocol"),Net_1=require("../../../../Core/Net/Net"),StringUtils_1=require("../../../../Core/Utils/StringUtils"),EventDefine_1=require("../../../Common/Event/EventDefine"),EventSystem_1=require("../../../Common/Event/EventSystem"),ControllerHolder_1=require("../../../Manager/ControllerHolder"),ModelManager_1=require("../../../Manager/ModelManager"),UiControllerBase_1=require("../../../Ui/Base/UiControllerBase"),ScrollingTipsController_1=require("../../ScrollingTips/ScrollingTipsController");class PersonalController extends UiControllerBase_1.UiControllerBase{static OnAddEvents(){EventSystem_1.EventSystem.Add(EventDefine_1.EEventName.OnLoadingNetDataDone,this.xkt)}static OnRemoveEvents(){EventSystem_1.EventSystem.Remove(EventDefine_1.EEventName.OnLoadingNetDataDone,this.xkt)}static c3l(){var e=new Protocol_1.Aki.Protocol.y0_;Net_1.Net.Call(29171,e,e=>{e&&ModelManager_1.ModelManager.PersonalModel.InitPlayerHeadData(e.qE_)})}static SendBirthdayInitRequest(o){var e=Protocol_1.Aki.Protocol.SYn.create();e.ZVn=o,Net_1.Net.Call(27593,e,e=>{e&&(e.Q4n===Protocol_1.Aki.Protocol.Q4n.KRs?ModelManager_1.ModelManager.PersonalModel.SetBirthday(o):ControllerHolder_1.ControllerHolder.ErrorCodeController.OpenErrorCodeTipView(e.Q4n,21515))})}static SendBirthdayShowSetRequest(o){var e=Protocol_1.Aki.Protocol.wYn.create();e.$7n=o,Net_1.Net.Call(25274,e,e=>{e&&(e.Q4n===Protocol_1.Aki.Protocol.Q4n.KRs?ModelManager_1.ModelManager.PersonalModel.SetBirthdayDisplay(o):ControllerHolder_1.ControllerHolder.ErrorCodeController.OpenErrorCodeTipView(e.Q4n,16202))})}static SendRoleShowListUpdateRequest(o){var e=Protocol_1.Aki.Protocol.yYn.create();e.Y7n=o,Net_1.Net.Call(24461,e,e=>{e&&(e.Q4n===Protocol_1.Aki.Protocol.Q4n.KRs?ModelManager_1.ModelManager.PersonalModel.UpdateRoleShowList(o):ControllerHolder_1.ControllerHolder.ErrorCodeController.OpenErrorCodeTipView(e.Q4n,29915))})}static async SendRoleShowListUpdateRequestAsync(e){var o=Protocol_1.Aki.Protocol.yYn.create(),o=(o.Y7n=e,await Net_1.Net.CallAsync(24461,o));if(o){if(o.Q4n===Protocol_1.Aki.Protocol.Q4n.KRs)return ModelManager_1.ModelManager.PersonalModel.UpdateRoleShowList(e),!0;ControllerHolder_1.ControllerHolder.ErrorCodeController.OpenErrorCodeTipView(o.Q4n,29915)}return!1}static SendChangeCardRequest(o){var e=Protocol_1.Aki.Protocol.RYn.create();e.J7n=o,Net_1.Net.Call(25938,e,e=>{e&&(e.Q4n===Protocol_1.Aki.Protocol.Q4n.KRs?ModelManager_1.ModelManager.PersonalModel.SetCurCardId(o):ControllerHolder_1.ControllerHolder.ErrorCodeController.OpenErrorCodeTipView(e.Q4n,23260))})}static SendReadCardRequest(o){var e=Protocol_1.Aki.Protocol.AYn.create();e.J7n=o,Net_1.Net.Call(19369,e,e=>{e&&(e.Q4n===Protocol_1.Aki.Protocol.Q4n.KRs?ModelManager_1.ModelManager.PersonalModel.UpdateCardUnlockList(o,!0):ControllerHolder_1.ControllerHolder.ErrorCodeController.OpenErrorCodeTipView(e.Q4n,25756))})}static SendModifySignatureRequest(o){var e=Protocol_1.Aki.Protocol.uYn.create();e.zVn=o,Net_1.Net.Call(23755,e,e=>{e&&(e.Q4n===Protocol_1.Aki.Protocol.Q4n.KRs?ModelManager_1.ModelManager.PersonalModel.SetSignature(o):e.Q4n===Protocol_1.Aki.Protocol.Q4n.Proto_ContainsDirtyWord||e.Q4n===Protocol_1.Aki.Protocol.Q4n.Proto_ErrRoleInvalidNameLength?ScrollingTipsController_1.ScrollingTipsController.ShowTipsById("NotElegantName"):ControllerHolder_1.ControllerHolder.ErrorCodeController.OpenErrorCodeTipView(e.Q4n,18983))})}static SendChangeHeadPhotoRequest(o){var e=Protocol_1.Aki.Protocol.dYn.create();e.z7n=o,Net_1.Net.Call(20320,e,e=>{e&&(e.Q4n===Protocol_1.Aki.Protocol.Q4n.KRs?ModelManager_1.ModelManager.PersonalModel.SetHeadPhotoId(o):ControllerHolder_1.ControllerHolder.ErrorCodeController.OpenErrorCodeTipView(e.Q4n,22357))})}static CheckCardIsUsing(o){var r=ModelManager_1.ModelManager.PersonalModel.GetCardShowList(),t=r.length;let l=!1;for(let e=0;e<t;e++)if(r[e]===o){l=!0;break}return l}static CheckCardIsUnLock(o){var r=ModelManager_1.ModelManager.PersonalModel.GetCardDataList(),t=r.length;for(let e=0;e<t;e++){var l=r[e];if(l.CardId===o)return l.IsUnLock}return!1}static OnRegisterNetEvent(){Net_1.Net.Register(24619,e=>{ModelManager_1.ModelManager.PersonalModel.AddCardUnlockList(e.J7n,!1)}),Net_1.Net.Register(17036,e=>{ModelManager_1.ModelManager.PersonalModel.SetHeadPhotoId(e.dSs)}),Net_1.Net.Register(23787,e=>{ModelManager_1.ModelManager.PersonalModel.SetRoleShowList(e.MSs)}),Net_1.Net.Register(23109,e=>{ModelManager_1.ModelManager.PersonalModel.SetSignature(e.zVn)}),Net_1.Net.Register(28030,e=>{ModelManager_1.ModelManager.FunctionModel.SetPlayerName(e.H8n),ModelManager_1.ModelManager.PersonalModel.SetModifyNameInfo(e.Zha,StringUtils_1.EMPTY_STRING)}),Net_1.Net.Register(22486,e=>{ModelManager_1.ModelManager.PersonalModel.UpdatePlayerHeadData(e.OE_)})}static OnUnRegisterNetEvent(){Net_1.Net.UnRegister(24619),Net_1.Net.UnRegister(17036),Net_1.Net.UnRegister(23787),Net_1.Net.UnRegister(23109),Net_1.Net.UnRegister(28030),Net_1.Net.UnRegister(22486)}}exports.PersonalController=PersonalController,(_a=PersonalController).xkt=()=>{PersonalController.c3l()},PersonalController.RequestModifySignature=async e=>{var o=Protocol_1.Aki.Protocol.uYn.create(),o=(o.zVn=e,await Net_1.Net.CallAsync(23755,o));return o.Q4n===Protocol_1.Aki.Protocol.Q4n.KRs?ModelManager_1.ModelManager.PersonalModel.SetSignature(e):o.Q4n===Protocol_1.Aki.Protocol.Q4n.Proto_ContainsDirtyWord||o.Q4n===Protocol_1.Aki.Protocol.Q4n.Proto_ErrRoleInvalidNameLength?ScrollingTipsController_1.ScrollingTipsController.ShowTipsById("NotElegantName"):ControllerHolder_1.ControllerHolder.ErrorCodeController.OpenErrorCodeTipView(o.Q4n,18983),o.Q4n},PersonalController.RequestModifyName=async e=>{var o=Protocol_1.Aki.Protocol.lYn.create(),e=(o.H8n=e,await Net_1.Net.CallAsync(21061,o));return e.Q4n===Protocol_1.Aki.Protocol.Q4n.KRs?ModelManager_1.ModelManager.PersonalModel.SetModifyNameInfo(e.Zha,e.ela):e.Q4n===Protocol_1.Aki.Protocol.Q4n.Proto_ContainsDirtyWord||e.Q4n===Protocol_1.Aki.Protocol.Q4n.Proto_ErrRoleInvalidNameLength?ScrollingTipsController_1.ScrollingTipsController.ShowTipsById("NotElegantName"):ControllerHolder_1.ControllerHolder.ErrorCodeController.OpenErrorCodeTipView(e.Q4n,22357),e.Q4n};
//# sourceMappingURL=PersonalController.js.map