
"use strict";var _a;Object.defineProperty(exports,"__esModule",{value:!0}),exports.PersonalController=void 0;const Protocol_1=require("../../../../Core/Define/Net/Protocol"),Net_1=require("../../../../Core/Net/Net"),StringUtils_1=require("../../../../Core/Utils/StringUtils"),EventDefine_1=require("../../../Common/Event/EventDefine"),EventSystem_1=require("../../../Common/Event/EventSystem"),ControllerHolder_1=require("../../../Manager/ControllerHolder"),ModelManager_1=require("../../../Manager/ModelManager"),UiControllerBase_1=require("../../../Ui/Base/UiControllerBase"),ScrollingTipsController_1=require("../../ScrollingTips/ScrollingTipsController");class PersonalController extends UiControllerBase_1.UiControllerBase{static OnAddEvents(){EventSystem_1.EventSystem.Add(EventDefine_1.EEventName.OnLoadingNetDataDone,this.xkt)}static OnRemoveEvents(){EventSystem_1.EventSystem.Remove(EventDefine_1.EEventName.OnLoadingNetDataDone,this.xkt)}static i3l(){var e=new Protocol_1.Aki.Protocol.le1;Net_1.Net.Call(28204,e,e=>{e&&ModelManager_1.ModelManager.PersonalModel.InitPlayerHeadData(e.Lr1)})}static SendBirthdayInitRequest(o){var e=Protocol_1.Aki.Protocol.SYn.create();e.ZVn=o,Net_1.Net.Call(25206,e,e=>{e&&(e.Q4n===Protocol_1.Aki.Protocol.Q4n.KRs?ModelManager_1.ModelManager.PersonalModel.SetBirthday(o):ControllerHolder_1.ControllerHolder.ErrorCodeController.OpenErrorCodeTipView(e.Q4n,24526))})}static SendBirthdayShowSetRequest(o){var e=Protocol_1.Aki.Protocol.wYn.create();e.$7n=o,Net_1.Net.Call(29374,e,e=>{e&&(e.Q4n===Protocol_1.Aki.Protocol.Q4n.KRs?ModelManager_1.ModelManager.PersonalModel.SetBirthdayDisplay(o):ControllerHolder_1.ControllerHolder.ErrorCodeController.OpenErrorCodeTipView(e.Q4n,25318))})}static SendRoleShowListUpdateRequest(o){var e=Protocol_1.Aki.Protocol.yYn.create();e.Y7n=o,Net_1.Net.Call(27549,e,e=>{e&&(e.Q4n===Protocol_1.Aki.Protocol.Q4n.KRs?ModelManager_1.ModelManager.PersonalModel.UpdateRoleShowList(o):ControllerHolder_1.ControllerHolder.ErrorCodeController.OpenErrorCodeTipView(e.Q4n,21091))})}static async SendRoleShowListUpdateRequestAsync(e){var o=Protocol_1.Aki.Protocol.yYn.create(),o=(o.Y7n=e,await Net_1.Net.CallAsync(27549,o));if(o){if(o.Q4n===Protocol_1.Aki.Protocol.Q4n.KRs)return ModelManager_1.ModelManager.PersonalModel.UpdateRoleShowList(e),!0;ControllerHolder_1.ControllerHolder.ErrorCodeController.OpenErrorCodeTipView(o.Q4n,21091)}return!1}static SendChangeCardRequest(o){var e=Protocol_1.Aki.Protocol.RYn.create();e.J7n=o,Net_1.Net.Call(18021,e,e=>{e&&(e.Q4n===Protocol_1.Aki.Protocol.Q4n.KRs?ModelManager_1.ModelManager.PersonalModel.SetCurCardId(o):ControllerHolder_1.ControllerHolder.ErrorCodeController.OpenErrorCodeTipView(e.Q4n,23243))})}static SendReadCardRequest(o){var e=Protocol_1.Aki.Protocol.AYn.create();e.J7n=o,Net_1.Net.Call(22760,e,e=>{e&&(e.Q4n===Protocol_1.Aki.Protocol.Q4n.KRs?ModelManager_1.ModelManager.PersonalModel.UpdateCardUnlockList(o,!0):ControllerHolder_1.ControllerHolder.ErrorCodeController.OpenErrorCodeTipView(e.Q4n,29954))})}static SendModifySignatureRequest(o){var e=Protocol_1.Aki.Protocol.uYn.create();e.zVn=o,Net_1.Net.Call(21738,e,e=>{e&&(e.Q4n===Protocol_1.Aki.Protocol.Q4n.KRs?ModelManager_1.ModelManager.PersonalModel.SetSignature(o):e.Q4n===Protocol_1.Aki.Protocol.Q4n.Proto_ContainsDirtyWord||e.Q4n===Protocol_1.Aki.Protocol.Q4n.Proto_ErrRoleInvalidNameLength?ScrollingTipsController_1.ScrollingTipsController.ShowTipsById("NotElegantName"):ControllerHolder_1.ControllerHolder.ErrorCodeController.OpenErrorCodeTipView(e.Q4n,25650))})}static SendChangeHeadPhotoRequest(o){var e=Protocol_1.Aki.Protocol.dYn.create();e.z7n=o,Net_1.Net.Call(15996,e,e=>{e&&(e.Q4n===Protocol_1.Aki.Protocol.Q4n.KRs?ModelManager_1.ModelManager.PersonalModel.SetHeadPhotoId(o):ControllerHolder_1.ControllerHolder.ErrorCodeController.OpenErrorCodeTipView(e.Q4n,27803))})}static CheckCardIsUsing(o){var r=ModelManager_1.ModelManager.PersonalModel.GetCardShowList(),t=r.length;let l=!1;for(let e=0;e<t;e++)if(r[e]===o){l=!0;break}return l}static CheckCardIsUnLock(o){var r=ModelManager_1.ModelManager.PersonalModel.GetCardDataList(),t=r.length;for(let e=0;e<t;e++){var l=r[e];if(l.CardId===o)return l.IsUnLock}return!1}static OnRegisterNetEvent(){Net_1.Net.Register(27463,e=>{ModelManager_1.ModelManager.PersonalModel.AddCardUnlockList(e.J7n,!1)}),Net_1.Net.Register(23931,e=>{ModelManager_1.ModelManager.PersonalModel.SetHeadPhotoId(e.dSs)}),Net_1.Net.Register(15136,e=>{ModelManager_1.ModelManager.PersonalModel.SetRoleShowList(e.MSs)}),Net_1.Net.Register(17789,e=>{ModelManager_1.ModelManager.PersonalModel.SetSignature(e.zVn)}),Net_1.Net.Register(17146,e=>{ModelManager_1.ModelManager.FunctionModel.SetPlayerName(e.H8n),ModelManager_1.ModelManager.PersonalModel.SetModifyNameInfo(e.Zha,StringUtils_1.EMPTY_STRING)}),Net_1.Net.Register(26517,e=>{ModelManager_1.ModelManager.PersonalModel.UpdatePlayerHeadData(e.Rr1)})}static OnUnRegisterNetEvent(){Net_1.Net.UnRegister(27463),Net_1.Net.UnRegister(23931),Net_1.Net.UnRegister(15136),Net_1.Net.UnRegister(17789),Net_1.Net.UnRegister(17146),Net_1.Net.UnRegister(26517)}}exports.PersonalController=PersonalController,(_a=PersonalController).xkt=()=>{PersonalController.i3l()},PersonalController.RequestModifySignature=async e=>{var o=Protocol_1.Aki.Protocol.uYn.create(),o=(o.zVn=e,await Net_1.Net.CallAsync(21738,o));return o.Q4n===Protocol_1.Aki.Protocol.Q4n.KRs?ModelManager_1.ModelManager.PersonalModel.SetSignature(e):o.Q4n===Protocol_1.Aki.Protocol.Q4n.Proto_ContainsDirtyWord||o.Q4n===Protocol_1.Aki.Protocol.Q4n.Proto_ErrRoleInvalidNameLength?ScrollingTipsController_1.ScrollingTipsController.ShowTipsById("NotElegantName"):ControllerHolder_1.ControllerHolder.ErrorCodeController.OpenErrorCodeTipView(o.Q4n,25650),o.Q4n},PersonalController.RequestModifyName=async e=>{var o=Protocol_1.Aki.Protocol.lYn.create(),e=(o.H8n=e,await Net_1.Net.CallAsync(27405,o));return e.Q4n===Protocol_1.Aki.Protocol.Q4n.KRs?ModelManager_1.ModelManager.PersonalModel.SetModifyNameInfo(e.Zha,e.ela):e.Q4n===Protocol_1.Aki.Protocol.Q4n.Proto_ContainsDirtyWord||e.Q4n===Protocol_1.Aki.Protocol.Q4n.Proto_ErrRoleInvalidNameLength?ScrollingTipsController_1.ScrollingTipsController.ShowTipsById("NotElegantName"):ControllerHolder_1.ControllerHolder.ErrorCodeController.OpenErrorCodeTipView(e.Q4n,27803),e.Q4n};
//# sourceMappingURL=PersonalController.js.map