
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.WeaponSkinController=void 0;const Log_1=require("../../../../../Core/Common/Log"),Protocol_1=require("../../../../../Core/Define/Net/Protocol"),Net_1=require("../../../../../Core/Net/Net"),MathUtils_1=require("../../../../../Core/Utils/MathUtils"),EventDefine_1=require("../../../../Common/Event/EventDefine"),EventSystem_1=require("../../../../Common/Event/EventSystem"),ControllerHolder_1=require("../../../../Manager/ControllerHolder"),ModelManager_1=require("../../../../Manager/ModelManager"),UiControllerBase_1=require("../../../../Ui/Base/UiControllerBase"),UiManager_1=require("../../../../Ui/UiManager"),SkinRootViewModel_1=require("../../SkinRootViewModel"),WeaponSkinDefine_1=require("./WeaponSkinDefine");class WeaponSkinController extends UiControllerBase_1.UiControllerBase{static OnAddEvents(){EventSystem_1.EventSystem.Add(EventDefine_1.EEventName.OnLoadingNetDataDone,this.Q5e)}static OnRemoveEvents(){EventSystem_1.EventSystem.Remove(EventDefine_1.EEventName.OnLoadingNetDataDone,this.Q5e)}static bil(){var e=new Protocol_1.Aki.Protocol._ss;Net_1.Net.Call(24358,Protocol_1.Aki.Protocol._ss.create(e),e=>{e&&ModelManager_1.ModelManager.WeaponSkinModel.NotifyWeaponSkinData(e.qxs)})}static OnRegisterNetEvent(){Net_1.Net.Register(22766,e=>{e&&(e.wVn?ModelManager_1.ModelManager.WeaponSkinModel.NotifyAllUnlockSkinData(e.bBs):ModelManager_1.ModelManager.WeaponSkinModel.SetUnlockSkinData(e.bBs))}),Net_1.Net.Register(23735,e=>{e&&(ModelManager_1.ModelManager.WeaponSkinModel.DeleteWeaponSkinData(e.Q6n),Log_1.Log.CheckInfo())&&Log_1.Log.Info("WeaponSkin,",10,"武器皮肤卸载成功",["roleId",e.Q6n])}),Net_1.Net.Register(26591,e=>{var o=MathUtils_1.MathUtils.LongToNumber(e.F4n),o=ModelManager_1.ModelManager.CreatureModel.GetEntity(o).Entity.GetComponent(72);o&&o.OnEntityEquipSkinChangeNotify(e)})}static OnUnRegisterNetEvent(){Net_1.Net.UnRegister(22766),Net_1.Net.UnRegister(23735)}static aol(o,t){var e=Protocol_1.Aki.Protocol.CMl.create();e.R5n=Protocol_1.Aki.Protocol.LTl.create(),e.R5n.mjn=o,e.R5n.lol=t,Net_1.Net.Call(26e3,e,e=>{e&&(e.Q4n===Protocol_1.Aki.Protocol.Q4n.KRs?(ModelManager_1.ModelManager.WeaponSkinModel.EquipWeaponSkinData(e.Gxs),Log_1.Log.CheckInfo()&&Log_1.Log.Info("WeaponSkin,",10,"武器皮肤装备成功",["roleId",o],["skinId",t])):ControllerHolder_1.ControllerHolder.ErrorCodeController.OpenErrorCodeTipView(e.Q4n,20695))})}static hol(e){var o;!e||e<=0||((o=Protocol_1.Aki.Protocol.fMl.create()).mjn=e,Net_1.Net.Call(24130,o,e=>{e&&e.Q4n!==Protocol_1.Aki.Protocol.Q4n.KRs&&ControllerHolder_1.ControllerHolder.ErrorCodeController.OpenErrorCodeTipView(e.Q4n,22666)}))}static SendEquipSkinRequest(e,o){!e||e<=0||(o===WeaponSkinDefine_1.WEAPON_SKIN_DEFAULT_ID?WeaponSkinController.hol(e):WeaponSkinController.aol(e,o))}static SkipToWeaponSkinView(e){var o=new SkinRootViewModel_1.SkinRootViewModel;o.SetViewData(e),UiManager_1.UiManager.OpenView("SkinRootView",o)}}(exports.WeaponSkinController=WeaponSkinController).Q5e=()=>{WeaponSkinController.bil()};
//# sourceMappingURL=WeaponSkinController.js.map