
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.VisionAssembleStaticItem=exports.VisionAssembleView=void 0;const UE=require("ue"),MultiTextLang_1=require("../../../../../../Core/Define/ConfigQuery/MultiTextLang"),StringUtils_1=require("../../../../../../Core/Utils/StringUtils"),EventDefine_1=require("../../../../../Common/Event/EventDefine"),EventSystem_1=require("../../../../../Common/Event/EventSystem"),ConfigManager_1=require("../../../../../Manager/ConfigManager"),ControllerHolder_1=require("../../../../../Manager/ControllerHolder"),ModelManager_1=require("../../../../../Manager/ModelManager"),PreloadControllerClassPart2_1=require("../../../../../Preload/PreloadControllerClassPart2"),UiPanelBase_1=require("../../../../../Ui/Base/UiPanelBase"),UiViewBase_1=require("../../../../../Ui/Base/UiViewBase"),PopupCaptionItem_1=require("../../../../../Ui/Common/PopupCaptionItem"),ButtonItem_1=require("../../../../Common/Button/ButtonItem"),CommonDropDown_1=require("../../../../Common/DropDown/CommonDropDown"),FilterEntrance_1=require("../../../../Common/FilterSort/Filter/View/FilterEntrance"),ConfirmBoxDefine_1=require("../../../../ConfirmBox/ConfirmBoxDefine"),GenericLayout_1=require("../../../../Util/Layout/GenericLayout"),LguiUtil_1=require("../../../../Util/LguiUtil"),GenericScrollViewNew_1=require("../../../../Util/ScrollView/GenericScrollViewNew"),LoopScrollView_1=require("../../../../Util/ScrollView/LoopScrollView"),VisionEquipmentDropDownTitleItem_1=require("../VisionEquipmentDropDownTitleItem"),VisionAssembleAttrScrollItem_1=require("./VisionAssembleAttrScrollItem"),VisionAssembleDropDownItem_1=require("./VisionAssembleDropDownItem"),VisionAssembleItem_1=require("./VisionAssembleItem"),VisionAssembleScrollItem_1=require("./VisionAssembleScrollItem"),VisionAssembleSuitItem_1=require("./VisionAssembleSuitItem"),EMPTYSELECTINDEX=999,STATICINDEX=-1;class VisionAssembleView extends UiViewBase_1.UiViewBase{constructor(){super(...arguments),this.Z6i=36,this.al_=new Array,this.Bo_=0,this.lqe=void 0,this.hl_=void 0,this.ll_=void 0,this._l_=void 0,this.vpt=void 0,this.i7i=new Array,this.Z9i=0,this.h8e=void 0,this.nvt=void 0,this.cl_=void 0,this.p9t=void 0,this.Yja=EMPTYSELECTINDEX,this.ul_=!1,this.c4_=void 0,this.u4_=void 0,this.a$_=void 0,this.WCo=()=>{this.dl_(),this.ml_(),this.Cl_(),this.gl_(),this.pl_(),this.fl_(),this.bqe(!0)},this.mU_=()=>{this.a7i(),this.h$_(),this.l$_();var t=ModelManager_1.ModelManager.VisionEquipGroupModel.GetVisionEquipGroupList().length;this.Yja=t-1,this.bqe(),this.yl_(),this.Sl_(),this.Cl_(),this.gl_(),this.pl_(),this.Pl_()},this.fU_=()=>{var t=ModelManager_1.ModelManager.VisionEquipGroupModel.GetVisionEquipGroupList().length;this.Yja=0<t?0:STATICINDEX,this.gU_()},this.CU_=()=>{var t=ModelManager_1.ModelManager.VisionEquipGroupModel.GetVisionEquipGroupList().length;this.Yja=0<t?0:STATICINDEX,this.gU_(),EventSystem_1.EventSystem.Emit(EventDefine_1.EEventName.OnVisionAssembleNavigationRefresh,!1)},this.pU_=()=>{this.pl_(),this.dl_(),this.bqe(!0)},this.g8e=t=>{return Number(t)},this.C8e=t=>{this.Z9i=t,this.a7i()},this.m8e=t=>{return new VisionAssembleDropDownItem_1.VisionAssembleDropDownItem(t)},this.c8e=t=>new VisionEquipmentDropDownTitleItem_1.VisionEquipmentDropDownTitleItem(t),this.Ml_=()=>{this.ul_=!this.ul_;var t=!!this.ul_;this.yl_(t),this.gl_(),this.ml_(),ModelManager_1.ModelManager.UiNavigationModel.TrySetCursorActive(!1),this.ul_?(this.dl_(),this.PlaySequence("Start_B",()=>{EventSystem_1.EventSystem.Emit(EventDefine_1.EEventName.OnVisionAssembleNavigationRefresh,!0)},!0)):(this.dl_(),this.PlaySequence("Close_B",()=>{EventSystem_1.EventSystem.Emit(EventDefine_1.EEventName.OnVisionAssembleNavigationRefresh,!0)},!0)),this._$_()},this.El_=()=>{this.Yja===STATICINDEX?this.Yja=EMPTYSELECTINDEX:this.Yja=STATICINDEX,this.Il_(),this.gl_(),this.Cl_(),this.yl_(),this.Pl_()},this.sOt=()=>{var t=this.RNr();2===t?(this.Tl_(),this.l$_()):1===t?this.bl_():3===t&&ControllerHolder_1.ControllerHolder.ScrollingTipsController.ShowTipsByTextId("VisionAssembleHasUseTips")},this.Ll_=()=>{var t=StringUtils_1.StringUtils.Format(MultiTextLang_1.configMultiTextLang.GetLocalTextNew("VisionAssembleCurrentIndex"),(this.Yja+1).toString()),e=ModelManager_1.ModelManager.VisionEquipGroupModel.GetVisionEquipGroupDataByIndex(this.Yja)?.GetName();PreloadControllerClassPart2_1.CommonInputViewController.OpenSetVisionEquipGroupName(t,async t=>ControllerHolder_1.ControllerHolder.VisionEquipGroupController.RequestChangeVisionGroupName(this.Yja,t),e)},this.Al_=()=>{var t;ModelManager_1.ModelManager.VisionEquipGroupModel.GetLocalTipsState()?ControllerHolder_1.ControllerHolder.VisionEquipGroupController.RequestPutVisionGroupToTop(this.Yja):((t=new ConfirmBoxDefine_1.ConfirmBoxDataNew(242)).HasToggle=!0,t.ToggleText=MultiTextLang_1.configMultiTextLang.GetLocalTextNew("VisionAssembleTopNeverTips"),t.SetToggleFunction(this.RMt),t.FunctionMap.set(2,()=>{ControllerHolder_1.ControllerHolder.VisionEquipGroupController.RequestPutVisionGroupToTop(this.Yja)}),ControllerHolder_1.ControllerHolder.ConfirmBoxController.ShowConfirmBoxNew(t))},this.RMt=t=>{ModelManager_1.ModelManager.VisionEquipGroupModel.SaveLocalTopTipState(t)},this.qHe=()=>{var t=new ConfirmBoxDefine_1.ConfirmBoxDataNew(243);t.FunctionMap.set(2,()=>{ControllerHolder_1.ControllerHolder.VisionEquipGroupController.RequestDeleteVisionEquipGroup(this.Yja)}),ControllerHolder_1.ControllerHolder.ConfirmBoxController.ShowConfirmBoxNew(t)},this.xl_=()=>{return new VisionAssembleScrollItem_1.VisionAssembleScrollItem},this.sGe=()=>{return new VisionAssembleAttrScrollItem_1.VisionAssembleAttrScrollItem},this.Qvt=(t,e,i)=>{this.al_=t;t=this.Ul_();0===t.length?this.Yja=STATICINDEX:this.Yja=t[0].GetIndex(),this.Il_(!1),this.cP_(),this.l$_()},this.AMo=()=>{this.CloseMe()},this.jq_=()=>!0,this.Rl_=t=>{t=t.GetIndex();t===this.Yja?(this.Yja=EMPTYSELECTINDEX,this.ul_=!1):this.Yja=t,this.Il_(),this.Pl_(),this.dl_()}}OnRegisterComponent(){this.ComponentRegisterInfos=[[0,UE.UIItem],[1,UE.UIItem],[2,UE.UILoopScrollViewComponent],[3,UE.UIItem],[4,UE.UIItem],[5,UE.UIItem],[6,UE.UIItem],[7,UE.UIText],[9,UE.UIItem],[8,UE.UIItem],[10,UE.UIScrollViewWithScrollbarComponent],[11,UE.UIButtonComponent],[12,UE.UIButtonComponent],[13,UE.UIExtendToggle],[14,UE.UIItem],[15,UE.UIItem],[16,UE.UIItem],[17,UE.UIItem],[18,UE.UIItem],[19,UE.UIItem]],this.BtnBindInfo=[[13,this.Ml_],[11,this.Al_],[12,this.qHe]]}async OnCreateAsync(){await ControllerHolder_1.ControllerHolder.VisionEquipGroupController.RequestVisionEquipGroupInfo()}OnAddEventListener(){EventSystem_1.EventSystem.Add(EventDefine_1.EEventName.OnVisionGroupDataAdd,this.mU_),EventSystem_1.EventSystem.Add(EventDefine_1.EEventName.OnVisionGroupDataDelete,this.fU_),EventSystem_1.EventSystem.Add(EventDefine_1.EEventName.OnVisionGroupDataToTop,this.CU_),EventSystem_1.EventSystem.Add(EventDefine_1.EEventName.OnVisionGroupDataChangeName,this.pU_),EventSystem_1.EventSystem.Add(EventDefine_1.EEventName.PhantomEquip,this.WCo)}OnRemoveEventListener(){EventSystem_1.EventSystem.Remove(EventDefine_1.EEventName.OnVisionGroupDataAdd,this.mU_),EventSystem_1.EventSystem.Remove(EventDefine_1.EEventName.OnVisionGroupDataDelete,this.fU_),EventSystem_1.EventSystem.Remove(EventDefine_1.EEventName.OnVisionGroupDataToTop,this.CU_),EventSystem_1.EventSystem.Remove(EventDefine_1.EEventName.OnVisionGroupDataChangeName,this.pU_),EventSystem_1.EventSystem.Remove(EventDefine_1.EEventName.PhantomEquip,this.WCo)}async OnBeforeStartAsync(){this.Bo_=this.OpenParam,this.lqe=new PopupCaptionItem_1.PopupCaptionItem(this.GetItem(0)),this.lqe.SetCloseCallBack(this.AMo),this.hl_=new VisionAssembleStaticItem,await this.hl_.CreateByActorAsync(this.GetItem(1).GetOwner()),this.hl_.BindClickCallBack(this.El_),this.hl_.SetActive(!0),this.ll_=new VisionAssembleTopItem,await this.ll_.CreateByActorAsync(this.GetItem(9).GetOwner()),this.ll_.BindClickReNameCallBack(this.Ll_),this._l_=new VisionAssembleTopItem,await this._l_.CreateByActorAsync(this.GetItem(8).GetOwner()),this._l_.SetReBtnActive(!1),this.nvt=new GenericScrollViewNew_1.GenericScrollViewNew(this.GetScrollViewWithScrollbar(10),this.sGe),this.p9t=new ButtonItem_1.ButtonItem(this.GetItem(15)),this.p9t.SetFunction(this.sOt),this.cl_=new LoopScrollView_1.LoopScrollView(this.GetLoopScrollViewComponent(2),this.GetItem(3).GetOwner(),this.xl_),this.vpt=new FilterEntrance_1.FilterEntrance(this.GetItem(5),this.Qvt),await this.aHi();var e=this.GetItem(19)?.GetOwner()?.K2_GetComponentsByClass(UE.UIInturnAnimController.StaticClass());if(e)for(let t=0;t<e.Num();t++){var i=e.Get(t);"Start_R"===i.AnimName&&(this.c4_=i,this.c4_.PlayFromIndex=1),"Start_L"===i.AnimName&&(this.u4_=i,this.u4_.PlayFromIndex=1)}}async aHi(){this.h8e=new CommonDropDown_1.CommonDropDown(this.GetItem(6),this.m8e,this.c8e),await this.h8e.Init();var t=ConfigManager_1.ConfigManager.PhantomBattleConfig.GetFetterGroupArray();this.i7i.push(0),t.forEach(t=>{this.i7i.push(t.Id)}),this.h8e.SetOnSelectCall(this.C8e),this.h8e.SetShowType(1),this.h8e.InitScroll(this.i7i,this.g8e,this.Z9i)}gU_(){this.bqe(),this.yl_(),this.Sl_(),this.Cl_(),this.gl_(),this.pl_(),this.a7i()}_$_(t=!1){var e;this.Yja!==STATICINDEX&&this.a$_?.length&&(e=this.a$_.findIndex(t=>t.CurrentSelectState),this.cl_?.ScrollToGridIndex(0<=e?e:0,t))}l$_(){return!!this.ul_&&(this.Ml_(),!0)}h$_(){let t=!1;return 0!==this.Z9i&&(this.h8e.SetSelectedIndex(0),t=!0),t=this.vpt.TryClearData()?!0:t}bl_(){var t,e;let i=!0;for(const s of ModelManager_1.ModelManager.RoleModel.GetRoleInstanceById(this.Bo_).GetPhantomData().GetIncrIdList())if(0!==s){i=!1;break}i?ControllerHolder_1.ControllerHolder.ScrollingTipsController.ShowTipsByTextId("VisionAssembleSaveNone"):ConfigManager_1.ConfigManager.PhantomBattleConfig.GetPhantomEquipGroupCountMax()<=(t=ModelManager_1.ModelManager.VisionEquipGroupModel.GetVisionEquipGroupList().length)?(e=new ConfirmBoxDefine_1.ConfirmBoxDataNew(245),ControllerHolder_1.ControllerHolder.ConfirmBoxController.ShowConfirmBoxNew(e)):(e=StringUtils_1.StringUtils.Format(MultiTextLang_1.configMultiTextLang.GetLocalTextNew("VisionAssembleCurrentIndex"),(t+1).toString()),PreloadControllerClassPart2_1.CommonInputViewController.OpenSetVisionEquipGroupName(e,async t=>ControllerHolder_1.ControllerHolder.VisionEquipGroupController.RequestAddVisionEquipGroup(this.Bo_,t)))}Tl_(){var t;let e=!1;for(const s of ModelManager_1.ModelManager.VisionEquipGroupModel.GetVisionEquipGroupDataByIndex(this.Yja).GetVisionUniqueIdList()){var i=ModelManager_1.ModelManager.PhantomBattleModel.GetPhantomEquipOnRoleId(s);if(i&&i!==this.Bo_){e=!0;break}}e?((t=new ConfirmBoxDefine_1.ConfirmBoxDataNew(244)).FunctionMap.set(2,()=>{ControllerHolder_1.ControllerHolder.VisionEquipGroupController.RequestApplyVisionGroup(this.Yja,this.Bo_)}),ControllerHolder_1.ControllerHolder.ConfirmBoxController.ShowConfirmBoxNew(t)):ControllerHolder_1.ControllerHolder.VisionEquipGroupController.RequestApplyVisionGroup(this.Yja,this.Bo_)}a7i(){var t=ModelManager_1.ModelManager.VisionEquipGroupModel.GetVisionEquipGroupList(),e=new Array;for(const i of t)e.push(i.GetIndex());this.vpt.UpdateData(this.Z6i,e,this.Bo_)}OnBeforeShow(){this.a7i(),this.Yja=STATICINDEX,this.bqe(!1,!0),this.wl_(),this.fl_(),this.dl_(),this.yl_(!1,()=>{for(const t of this.nvt?.GetScrollItemList())t.SetRightItemAlpha(0);this.c4_?.Play()}),this.Sl_(),this.ml_(),this.Cl_(),this.gl_(),this.pl_(),this.Pl_(),this.cP_(),this.Jk_()}wl_(){var e=ModelManager_1.ModelManager.VisionEquipGroupModel.GetVisionEquipGroupList(),i=e.length;this.al_=new Array;for(let t=0;t<i;t++){var s=e[t];this.al_.push(s.GetIndex())}}fl_(){this.hl_?.Refresh(this.Bo_)}Ul_(){var s=ModelManager_1.ModelManager.VisionEquipGroupModel.GetVisionEquipGroupList(),r=new Array;const n=0<this.Z9i?this.i7i[this.Z9i]:0;var t=s.length,h=this.x8_();for(let i=0;i<t;i++){var o=s[i];let t=!1,e=(0<n&&!ModelManager_1.ModelManager.VisionEquipGroupModel.GetVisionFetterDataByIncIdList(o.GetVisionUniqueIdList()).find(t=>t.FetterGroupId===n)||(t=!0),!h);0<this.al_.length?e=this.al_.includes(o.GetIndex()):h||(e=!0),t&&e&&r.push(o)}return r}bqe(t=!1,e=!1){var i=this.x8_()||0<this.Z9i,s=this.Ul_(),r=s.length,n=(ModelManager_1.ModelManager.VisionEquipGroupModel.FilterDataLength=r,ConfigManager_1.ConfigManager.PhantomBattleConfig.GetPhantomEquipGroupCountMax()),h=new Array,n=i?s.length:n;for(let t=0;t<n;t++){var o=new VisionAssembleScrollItem_1.VisionAssembleScrollItemData,a=t<r?s[t]:void 0;o.GroupIndex=t,o.ClickCallback=this.Rl_,o.CurrentSelectState=a?.GetIndex()===this.Yja,o.VisionEquipGroupData=a,o.CheckIfCanSelect=this.jq_,h.push(o)}this.a$_=h,this.cl_?.RefreshByData(h,t,()=>{t?e&&this.cl_?.GetUiAnimController()?.Play():this._$_(e)})}ml_(){this.hl_?.RefreshSelectState(this.Yja===STATICINDEX,this.ul_)}Il_(t=!0){this.bqe(t),this.ml_(),this.pl_(),this.Cl_(),this.gl_(),this.Pl_(),this.yl_(!1,()=>{for(const t of this.nvt?.GetScrollItemList())t.SetRightItemAlpha(0);this.c4_?.Play()})}Cl_(){var t=this.RNr();this.Dl_(t)}Dl_(e){var t=2===e||1===e||3===e;if(this.p9t.SetActive(t),t){let t="";t=2===e||3===e?"VisionAssembleUse":"VisionAssembleSave",this.p9t?.SetShowText(t)}}RNr(){if(this.Yja===EMPTYSELECTINDEX)return 0;if(this.Yja===STATICINDEX)return 1;var e=ModelManager_1.ModelManager.VisionEquipGroupModel.GetVisionEquipGroupDataByIndex(this.Yja).GetVisionUniqueIdList(),i=ModelManager_1.ModelManager.RoleModel.GetRoleInstanceById(this.Bo_).GetPhantomData().GetIncrIdList();let s=!0;for(let t=0;t<e.length;t++)if(e[t]!==i[t]){s=!1;break}return s?3:2}gl_(){var t=!this.ul_&&this.Yja!==STATICINDEX&&this.Yja!==EMPTYSELECTINDEX;this.Bl_(t),this.ql_(t)}Bl_(t){this.GetButton(12).RootUIComp.SetUIActive(t)}ql_(t){this.GetButton(11).RootUIComp.SetUIActive(t)}dl_(){var t=this.ul_;this._l_?.SetActive(t),t&&this._l_?.Refresh(this.kl_())}U8_(){var t=ConfigManager_1.ConfigManager.FilterConfig.GetFilterId(this.Z6i);return ModelManager_1.ModelManager.FilterModel.GetFilterResultData(t)}x8_(){var t=this.U8_();if(t)for(const e of t.GetSelectRuleData().values())if(0<e.size)return!0;return!1}cP_(){var t=this.x8_()&&0===this.Ul_().length||0<this.Z9i&&0===this.Ul_().length;this.GetItem(18).SetUIActive(t)}yl_(e=!1,i=void 0){if(this.Yja===EMPTYSELECTINDEX)this.GetScrollViewWithScrollbar(10).RootUIComp.SetUIActive(!1),this.GetItem(14).SetUIActive(!0);else{var t=this.uP_();this.GetScrollViewWithScrollbar(10).RootUIComp.SetUIActive(!t),this.GetItem(14).SetUIActive(t);const s=ModelManager_1.ModelManager.VisionEquipGroupModel.GetVisionAssembleViewAttrData(this.Yja,this.ul_,this.Bo_);this.nvt?.RefreshByData(s,()=>{if(0<s.length&&this.nvt?.ScrollToTop(0),i?.(),e){for(const t of this.nvt?.GetScrollItemList())t.SetLeftItemAlpha(0);this.u4_?.Play()}})}}Sl_(){var t=ModelManager_1.ModelManager.VisionEquipGroupModel.GetVisionEquipGroupList().length,e=ConfigManager_1.ConfigManager.PhantomBattleConfig.GetPhantomEquipGroupCountMax();LguiUtil_1.LguiUtil.SetLocalTextNew(this.GetText(7),"VisionAssembleHasSave",t,e)}Jk_(){this.PlaySequence("Start_InfR",void 0,!0),this.c4_?.OnFinish.Bind(()=>{this.c4_?.SetItemDefaultAlphaZero(!1)}),this.c4_?.Play("Start_R")}pl_(){var t=this.ll_?.GetActive();this.ll_?.Refresh(this.Ol_()),!0!==t&&(this.ll_?.SetActive(!0),this.yl_(),this.PlaySequence("Start_InfR",void 0,!0))}Pl_(){var t=this.Yja!==EMPTYSELECTINDEX&&this.Yja!==STATICINDEX;this.GetExtendToggle(13)?.RootUIComp.SetUIActive(t)}uP_(){if(this.Yja!==EMPTYSELECTINDEX)if(this.Yja===STATICINDEX){for(const t of ModelManager_1.ModelManager.RoleModel.GetRoleDataById(this.Bo_).GetPhantomData().GetIncrIdList())if(0!==t)return!1}else for(const e of ModelManager_1.ModelManager.VisionEquipGroupModel.GetVisionEquipGroupDataByIndex(this.Yja).GetVisionUniqueIdList())if(0!==e)return!1;return!0}Ol_(){if(this.Yja!==EMPTYSELECTINDEX){let t=[];var i=new VisionAssembleTopData;t=this.Yja===STATICINDEX?(i.Name=MultiTextLang_1.configMultiTextLang.GetLocalTextNew("VisionAssembleCurrentEquip"),Array.from(ModelManager_1.ModelManager.RoleModel.GetRoleDataById(this.Bo_).GetPhantomData().GetIncrIdList())):(s=ModelManager_1.ModelManager.VisionEquipGroupModel.GetVisionEquipGroupDataByIndex(this.Yja),i.Name=s.GetName(),s.GetVisionUniqueIdList()),i.Index=this.Yja===STATICINDEX?STATICINDEX:this.Yja;let e=0;var s=this.dP_(ModelManager_1.ModelManager.VisionEquipGroupModel.GetVisionFetterDataByIncIdList(t));for(const o of t){var r=ModelManager_1.ModelManager.PhantomBattleModel.GetPhantomDataBase(o);r&&(e+=r.GetCost())}i.Cost=e;var n=new Array;for(const a of s){var h=new VisionAssembleSuitItem_1.VisionAssembleSuitItemData;h.Phrase(a),n.push(h)}return i.SuitList=n,i}}kl_(){const e=new VisionAssembleTopData;e.Name=MultiTextLang_1.configMultiTextLang.GetLocalTextNew("VisionAssembleCurrentEquip"),e.Index=-1;let i=0;var t=ModelManager_1.ModelManager.RoleModel.GetRoleDataById(this.Bo_),s=t.GetPhantomData().GetDataMap(),r=s.size;for(let t=0;t<r;t++){const e=s.get(t);e&&(i+=e.GetCost())}e.Cost=i;var t=t.GetPhantomData().GetIncrIdList(),t=this.dP_(ModelManager_1.ModelManager.VisionEquipGroupModel.GetVisionFetterDataByIncIdList(Array.from(t))),n=new Array;for(const o of t){var h=new VisionAssembleSuitItem_1.VisionAssembleSuitItemData;h.Phrase(o),n.push(h)}return e.SuitList=n,e}dP_(t){var e=new Array,i=new Map;for(const s of t)i.set(s.FetterGroupId,s);for(const r of i.values())e.push(r);return e}}exports.VisionAssembleView=VisionAssembleView;class VisionAssembleStaticItem extends UiPanelBase_1.UiPanelBase{constructor(){super(...arguments),this.ol_=[],this.Nji=void 0,this.kqe=()=>{this.Nji?.()}}OnRegisterComponent(){this.ComponentRegisterInfos=[[0,UE.UIExtendToggle],[1,UE.UIItem],[2,UE.UIItem],[3,UE.UIItem],[4,UE.UIItem],[5,UE.UIItem]],this.BtnBindInfo=[[0,this.kqe]]}BindClickCallBack(t){this.Nji=t}async OnBeforeStartAsync(){var e=[];for(let t=0;t<5;t++){var i=new VisionAssembleItem_1.VisionAssembleItem;this.ol_.push(i),e.push(i.CreateByActorAsync(this.GetItem(1+t).GetOwner()))}await Promise.all(e);for(const t of this.ol_)t.SetActive(!0)}RefreshSelectState(t,e){e?(this.GetExtendToggle(0).SetToggleState(2),this.GetExtendToggle(0).SetSelfInteractive(!1)):(this.GetExtendToggle(0).SetToggleState(t?1:0),this.GetExtendToggle(0).SetSelfInteractive(!0))}Refresh(t){for(const r of this.ol_)r.Reset();var e=ModelManager_1.ModelManager.RoleModel.GetRoleDataById(t).GetPhantomData().GetDataMap(),i=e.size;for(let t=0;t<i;t++){var s=e.get(t);s&&this.ol_[t].Update(s.GetIncrId())}}}exports.VisionAssembleStaticItem=VisionAssembleStaticItem;class VisionAssembleTopData{constructor(){this.Name="",this.Index=0,this.Cost=0,this.SuitList=[]}}class VisionAssembleTopItem extends UiPanelBase_1.UiPanelBase{constructor(){super(...arguments),this.eGe=void 0,this.Gl_=void 0,this.Fl_=!0,this.Ll_=()=>{this.Gl_?.()},this.sGe=()=>{return new VisionAssembleSuitItem_1.VisionAssembleSuitItem}}OnRegisterComponent(){this.ComponentRegisterInfos=[[0,UE.UIText],[1,UE.UIText],[2,UE.UIText],[3,UE.UIHorizontalLayout],[4,UE.UIItem],[5,UE.UIButtonComponent]],this.BtnBindInfo=[[5,this.Ll_]]}OnStart(){this.eGe=new GenericLayout_1.GenericLayout(this.GetHorizontalLayout(3),this.sGe),ModelManager_1.ModelManager.VisionEquipGroupModel.SaveVisionGroupFirstOpenState(!1)}SetReBtnActive(t){this.Fl_=t}BindClickReNameCallBack(t){this.Gl_=t}Refresh(e){if(e){this.GetButton(5).RootUIComp.SetUIActive(this.Fl_&&0<=e.Index),this.SetActive(!0),this.GetText(0).SetText(e.Name);let t=0<=e.Index?(e.Index+1).toString():"";-1===e.Index?t="":t.length<2&&(t="0"+t),this.GetText(1).SetText(t);var i=ModelManager_1.ModelManager.PhantomBattleModel.GetMaxCost();this.GetText(2).SetText(e.Cost+"/"+i),this.eGe?.RefreshByData(e.SuitList)}else this.SetActive(!1)}}
//# sourceMappingURL=VisionAssembleView.js.map