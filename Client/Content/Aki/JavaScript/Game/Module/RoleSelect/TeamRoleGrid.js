
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.TeamRoleGrid=void 0;const ConfigManager_1=require("../../Manager/ConfigManager"),ModelManager_1=require("../../Manager/ModelManager"),LoopScrollMediumItemGrid_1=require("../Common/MediumItemGrid/LoopScrollMediumItemGrid"),MediumItemGridHalfAreaComponent_1=require("../Common/MediumItemGrid/MediumItemGridComponent/MediumItemGridHalfAreaComponent"),RoguelikeSelectRoleView_1=require("../Roguelike/View/RoguelikeSelectRoleView");class TeamRoleGrid extends LoopScrollMediumItemGrid_1.LoopScrollMediumItemGrid{constructor(){super(...arguments),this.IsHighlightIndex=void 0}OnRefresh(e,o,i){var t=e.GetLevelData(),a=e.GetDataId(),r=ModelManager_1.ModelManager.EditFormationModel,l=ModelManager_1.ModelManager.RoleSelectModel.GetRoleIndex(a);let d=!1;var n=e.IsTrialRole(),r=(n||ModelManager_1.ModelManager.TowerModel.IsOpenFloorFormation()||ModelManager_1.ModelManager.MowingTowerModel.IsOpenMowingTowerFormation()||(d=r.IsRoleDead(a)),this.IsHighlightIndex?.(l));let M=!1;ModelManager_1.ModelManager.InstanceDungeonEntranceModel.SelectInstanceId&&(s=ConfigManager_1.ConfigManager.InstanceDungeonConfig.GetConfig(ModelManager_1.ModelManager.InstanceDungeonEntranceModel.SelectInstanceId).RecommendRole,M=s.includes(e.GetRoleId()));var s={Type:2,ItemConfigId:a,IsTrialRoleVisible:n,BottomTextId:"Text_LevelShow_Text",BottomTextParameter:[t.GetLevel()],Index:0<l?l:void 0,HighlightIndex:r,ElementId:e.GetRoleConfig().ElementId,IsShowCost:ModelManager_1.ModelManager.TowerModel.IsOpenFloorFormation(),Data:e,IsDisable:d,IsRecommendVisible:M},t=(this.Apply(s),e.IsTrialRole()?this.SetLevelAndLock():(n=!e||!ModelManager_1.ModelManager.EditBattleTeamModel.CanAddRoleToEditTeam(a),this.SetLevelAndLock(void 0,n)),ModelManager_1.ModelManager.MowingTowerModel.OtherHalfAreaRoleList?.includes(a??-1)&&this.SetBelongToHalfArea(1-ModelManager_1.ModelManager.MowingTowerModel.CurrentOptionArea,!0),e.GetLevelData().GetLevel()<ModelManager_1.ModelManager.MowingTowerModel.AddLevel[0]),l=(-1!==ModelManager_1.ModelManager.MowingTowerModel.AddLevel[0]&&t&&this.SetAddLevelComponent(ModelManager_1.ModelManager.MowingTowerModel.AddLevel[0],t),ModelManager_1.ModelManager.RoleSelectModel.SelectedRoleSet.has(a));this.SetSelected(l,!0)}OnForceSelected(){this.SetSelected(!0,!0)}OnSelected(e){this.SetSelected(!0)}OnDeselected(e){this.SetSelected(!1)}SetAddLevelComponent(e,o){var i=this.Data.GetLevelData().GetLevel(),i=Math.max(i,e),e=this.RefreshComponent(RoguelikeSelectRoleView_1.RogueAddLevelComponent,!0,i);this.SetComponentVisible(e,o),i&&this.SetBottomTextVisible(!1)}SetBelongToHalfArea(e,o){e={BelongTo:e},e=this.RefreshComponent(MediumItemGridHalfAreaComponent_1.MediumItemGridHalfAreaComponent,!0,e);this.SetComponentVisible(e,o)}}exports.TeamRoleGrid=TeamRoleGrid;
//# sourceMappingURL=TeamRoleGrid.js.map