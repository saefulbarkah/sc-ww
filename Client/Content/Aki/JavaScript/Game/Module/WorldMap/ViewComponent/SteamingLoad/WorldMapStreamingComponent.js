
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.WorldMapStreamingComponent=void 0;const Vector2D_1=require("../../../../../Core/Utils/Math/Vector2D"),ModelManager_1=require("../../../../Manager/ModelManager"),MapComponent_1=require("../../../Map/Base/MapComponent");class WorldMapStreamingComponent extends MapComponent_1.MapComponent{constructor(){super(...arguments),this.z__=new Set,this.J__=new Map,this.Z__=Vector2D_1.Vector2D.Create()}get ComponentType(){return 8}get NYa(){var t=this.Parent;if(void 0!==t)return t;this.LogError(63,"[地图系统]->二级界面组件没有附加到容器下！")}OnUpdate(){for(const t of this.z__)this.e1_(t)}OnRemove(){this.z__.clear(),this.J__.clear()}Bind(t){this.z__.add(t)}Unbind(t){this.z__.delete(t),this.J__.delete(t)}BindAll(t){for(const e of t)this.Bind(e)}e1_(t){var e=this.IsInStreamingRange(t),n=this.J__.get(t);void 0!==e&&e===n||(this.J__.set(t,e),e?t.OnLoad():t.OnUnload())}IsInStreamingRange(t){var e,n,o,r;return!t.IsStreaming||(n=this.NYa.MoveComponent,e=this.NYa.OutOfViewPortSize,n=n.MapUiPosition,r=t.GetUiPosition(),o=ModelManager_1.ModelManager.WorldMapModel.MapScale,this.Z__.Set(r.X*o+n.X,r.Y*o+n.Y),r=t.GetPreloadThreshold(),Math.abs(this.Z__.X)<=e.X+r.X&&Math.abs(this.Z__.Y)<=e.Y+r.Y)}}exports.WorldMapStreamingComponent=WorldMapStreamingComponent;
//# sourceMappingURL=WorldMapStreamingComponent.js.map